% FUNCTION
% Compute_L.m
%__________________________________________________________________________
%
% PURPOSE
% Computation of the generalised muscle lever arms
%
% SYNOPSIS
% (Segment,Model) = Compute_L(Segment,Model)
%
% INPUT
% Segment (cf. data structure in user guide)
% Model (cf. data structure in user guide)
%
% OUTPUT
% Segment (cf. data structure in user guide)
% Model (cf. data structure in user guide)
%
% DESCRIPTION
% Definition of the virtuels markers for origin, via and insertion of
% muscles and computation of the lever arms
%
% REFERENCES
%__________________________________________________________________________
%
% CALLED FUNCTIONS (FROM MUSCULO-SKELETAL TOOLBOX)
% Mprod_array3.m
% Vnorm_array3.m
%
% MATLAB VERSION
% Matlab R2012a
%__________________________________________________________________________
%
% CHANGELOG
% Created by Raphaï¿½l Dumas, Florent Moissent, Edouard Jouan
% September 2012
%__________________________________________________________________________


function [Segment,Model] = Compute_L_KleinHorsman(Segment,Model,f,weight)

% Number of frames
n = size(Segment(2).rM,3);

% -------------------------------------------------------------------------
% Rotation matrix R and translation vector d, for flex digit and hal
% Found by least square matching of the same via point in the tibia and
% foot coordiante systems
% -------------------------------------------------------------------------
R = [0.9838    0.1711    0.0540
    -0.0064   -0.2673    0.9636
    0.1793   -0.9483   -0.2619];
d = [-0.0267;  -0.0294;   -0.0670];

% -------------------------------------------------------------------------
% Geometry length (data from the Delp et al. model)
% -------------------------------------------------------------------------
% Lm(2) not used: length in meter of foot segment
Model.Lm(3) = 0.4028; % Length in meter of shank segment
% Lm(4) not used: length in meter of patella segment
Model.Lm(5) = 0.3851; % Length in meter of thigh segment
% Lm(6) = 0.1069; % Length in meter of pelvis segment (computed using regressions for HJC and LJC)
Model.Lm(6) = Segment(6).L; % No scaling

% -------------------------------------------------------------------------
% Virtual markers
% Coordinates in (ui, rPi-rDi, wi)
% % -------------------------------------------------------------------------
% Foot (i = 2)
% Scaled by the shank length
% Virtual markers start at 4 (others are for ankle joint)
Segment(2).nV(:,4)  = inv(Segment(2).B) * ...
    [0.0475 ;  -0.0029 ;   0.0264]* ... % Via 5 extensor digitorum longus 1&2&3
    (Segment(3).L/Model.Lm(3));
Segment(2).nV(:,5)  = inv(Segment(2).B) * ...
    [ 0.0774  ; -0.0006  ; -0.0007]* ... % Via 7 of extensor hallucis longus 1&2&3
    (Segment(3).L/Model.Lm(3));
Segment(2).nV(:,6)  = inv(Segment(2).B) * ...
    (R*[0.0319 ;  -0.0261  ; -0.0135]+d)* ... % Via 7 of flexor digitorum longus 1&2&3 (R*rVs+d)
    (Segment(3).L/Model.Lm(3));
Segment(2).nV(:,7)  = inv(Segment(2).B) * ...
    (R*[0.0216  ; -0.0308 ;  -0.0144 ]+d)* ... % Via 8 of flexor hallucis longus 1&2&3(R*rVs+d)
    (Segment(3).L/Model.Lm(3));
Segment(2).nV(:,8)  = inv(Segment(2).B) * ...
    [-0.0381 ;  -0.0582  ;  0.0074 ]* ... %	Insertion of gastrocnemius (lat)
    (Segment(3).L/Model.Lm(3));
Segment(2).nV(:,9)  = inv(Segment(2).B) * ...
    [ -0.0385  ; -0.0652   ; 0.0020  ]* ... % Insertion of gastrocnemius (med)
    (Segment(3).L/Model.Lm(3));
Segment(2).nV(:,10)  = inv(Segment(2).B) * ...
    [ 0.0142  ; -0.0260   ; 0.0277 ]* ... %	Insertion (*1/3) of peroneus brevis  1&2&3
    (Segment(3).L/Model.Lm(3));
Segment(2).nV(:,11)  = inv(Segment(2).B) * ...
    [0.0083 ;  -0.0217 ;   0.0256 ]* ...% Insertion *(1/3) of peroneus longus  1&2&3
    (Segment(3).L/Model.Lm(3));
Segment(2).nV(:,12)  = inv(Segment(2).B) * ...
    [0.1065 ; -0.0567 ;   0.0351 ]* ... % Insertion of peroneus tertius 1&2&3
    (Segment(3).L/Model.Lm(3));
Segment(2).nV(:,13)  = inv(Segment(2).B) * ...
    [-0.0322 ;  -0.0524  ; -0.0081 ]* ... %	Insertion of plantaris
    (Segment(3).L/Model.Lm(3));
Segment(2).nV(:,14)  = inv(Segment(2).B) * ...
    [-0.0336 ;  -0.0580 ;  -0.0073 ]* ... %	Insertion of Soleus (med) 1&2&3
    (Segment(3).L/Model.Lm(3));
Segment(2).nV(:,15)  = inv(Segment(2).B) * ...
    [-0.0381 ;  -0.0582  ;  0.0074]* ... % Insertion of Soleus (lat) 1&2&3
    (Segment(3).L/Model.Lm(3));
Segment(2).nV(:,16)  = inv(Segment(2).B) * ...
    [0.0718   ;-0.0139;   -0.0222 ]* ... %	Via 2 tibialis anterior 1&2&3
    (Segment(3).L/Model.Lm(3));
Segment(2).nV(:,17)= inv(Segment(2).B) * ...
    [0.0405 ;  -0.0182  ; -0.0191]*... % Insertion of tibialis posterior
    (Segment(3).L/Model.Lm(3));

%--------------------------------------------------------------------------
% Shank (i = 3)
% Virtual markers start at 10 (others are for ankle, tibio-femoral and patello-femoral joints)
Segment(3).nV(:,10	)= inv(Segment(3).B) *...
    [-0.00170939085884629;-0.048226451741705;0.0524417756687994]*... % Insertion of biceps femoris CL
    (Segment(3).L/Model.Lm(3));
% Also insertion of biceps femoris CB 1&2&3
Segment(3).nV(:,11	)= inv(Segment(3).B) *...
    [0.0213313202698498;-0.39792104319058;0.0185596514424671]*... % Via 4 of extensor digitorum longus 1&2&3
    (Segment(3).L/Model.Lm(3));
Segment(3).nV(:,12	)= inv(Segment(3).B) *...
    [ 0.0302;   -0.3919;   -0.0021]*... % Via 6 of extensor hallucis longus 1&2&3
    (Segment(3).L/Model.Lm(3));
Segment(3).nV(:,13	)= inv(Segment(3).B) *...
    [-0.0073;   -0.4128  ; -0.0259]*... % Via 6 of flexor digitorum longus 1&2&3
    (Segment(3).L/Model.Lm(3));
Segment(3).nV(:,14	)= inv(Segment(3).B) *...
    [-0.0141 ;  -0.4223 ;  -0.0231]*... % Via 7 of flexor hallucis longus 1&2&3
    (Segment(3).L/Model.Lm(3));
Segment(3).nV(:,15	)= inv(Segment(3).B) *...
    [-0.0329646164615319;-0.0370136197711147;-0.0289459584913585]*... %V ia 1 of gracilis 1&2
    (Segment(3).L/Model.Lm(3));
Segment(3).nV(:,16	)= inv(Segment(3).B) *...
    [-0.0137;   -0.4115 ;   0.0200]*... % Via 4 of peroneus brevis/longus 1&2&3
    (Segment(3).L/Model.Lm(3));
Segment(3).nV(:,17	)= inv(Segment(3).B) *...
    [ 0.0239 ;  -0.4082   ; 0.0150]*... % Via 3 of peroneus tertius 1&2&3
    (Segment(3).L/Model.Lm(3));
Segment(3).nV(:,18	)= inv(Segment(3).B) *...
    [-0.0127221330095492;-0.044360763147423;0.0298950250822034]*... % Via 1 of popliteus 1&2
    (Segment(3).L/Model.Lm(3));
Segment(3).nV(:,19	)= inv(Segment(3).B) *...
    [0.00537395507198422;-0.0759041593975181;-0.0225490951712137]*... % Insertion of sartorius (prox & dist)
    (Segment(3).L/Model.Lm(3));
Segment(3).nV(:,20	)= inv(Segment(3).B) *...
    [-0.0420613921014435;-0.0335230283877114;-0.0161727660653743]*... % Insertion of semimembranosus
    (Segment(3).L/Model.Lm(3));
Segment(3).nV(:,21	)= inv(Segment(3).B) *...
    [-0.0492;-0.0294;-0.0065]*... % Via 1 of semitendinus
    (Segment(3).L/Model.Lm(3));
Segment(3).nV(:,22	)= inv(Segment(3).B) *...
    [-0.000712567819095711;	-0.179418079185038;-0.015452430509615]*... % Origin of soleus (med) 1
    (Segment(3).L/Model.Lm(3));
Segment(3).nV(:,23	)= inv(Segment(3).B) *...
    [-0.00304114499980055;-0.147749849153086;-0.0144224135404055]*... % Origin of soleus (med) 2
    (Segment(3).L/Model.Lm(3));
Segment(3).nV(:,24	)= inv(Segment(3).B) *...
    [-0.00820200944117189;-0.122863522184266;-0.0114548879349964]*... % Origin of soleus (med) 3
    (Segment(3).L/Model.Lm(3));
Segment(3).nV(:,25	)= inv(Segment(3).B) *...
    [-0.0206622877952993;-0.13985540349212;0.0405715229825122]*... % Origin of soleus (lat) 1
    (Segment(3).L/Model.Lm(3));
Segment(3).nV(:,26	)= inv(Segment(3).B) *...
    [-0.0196053587850955;-0.113012130715869;0.0430396412388283]*... % Origin of soleus (lat) 2
    (Segment(3).L/Model.Lm(3));
Segment(3).nV(:,27	)= inv(Segment(3).B) *...
    [-0.0195319088778824;-0.0737214427079635;0.0478982872412214]*... % Origin of soleus (lat) 3
    (Segment(3).L/Model.Lm(3));
Segment(3).nV(:,28	)= inv(Segment(3).B) *...
    [0.0286963307659905;0.0158374729652594;0.0331711855477543]*... % Insertion of tensor fascie late 1&2
    (Segment(3).L/Model.Lm(3));
Segment(3).nV(:,29	)= inv(Segment(3).B) *...
    [0.0286922574545016;-0.381340346186271;-0.0318674949235025]*... % Via 1 of tibialis anterior 1&2&3
    (Segment(3).L/Model.Lm(3));
% Also Origin of Tibialis posterioris (lat) 1&2&3
Segment(3).nV(:,30	)= inv(Segment(3).B) *...
    [0.0098 ;  -0.4132  ; -0.0350  ]*... % Via 11 of tibialis posterioris (med)
    (Segment(3).L/Model.Lm(3));

%--------------------------------------------------------------------------
% Patella (i = 4)
% Scaled by thigh length
% Virtual markers start at 2 (other is for patello-femoral joint)
Segment(4).nV(:,2) = [0;-1;0] + inv(Segment(4).B) * ...
    [0;0.047001702096839;0]*... % Insertion of rectus femoris 1                                  
    (Segment(5).L/Model.Lm(5));
% Also insertion of vastus intermedialis 1&2&3
% of vastus in medialis inf 1&2
% of vastus medialis mid 1&2
% of vastus  medialis sup 1&2&3&4&5&6
Segment(4).nV(:,3) = [0;-1;0] + inv(Segment(4).B) * ...
    [-0.00284741413104475;0.047987198322158;0.0112699170341316]*... % Insertion of rectus femoris 2
    (Segment(5).L/Model.Lm(5));
% Also insertion of vastus inter 4&5&6
% Also insertion of vastus lateralis inf 1&2&3&4&5&6
% Also insertion of vastus lateralis sup 1&2

%--------------------------------------------------------------------------
% Thigh (i = 5)
% Virtual markers start at 7 (others are for tibio-femoral joint)
Segment(5).nV(:,7	)  = inv(Segment(5).B) *...
    [-0.0191650771480102;-0.0806521569415341;0.0274472111258862]*... % Insertion of adductor brevis (prox) 1
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,8	)  = inv(Segment(5).B) *...
    [-0.0155440650122494;-0.093080408271426;0.0264639309045278]*... % Insertion of adductor brevis (prox) 2
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,9	)  = inv(Segment(5).B) *...
    [-0.0136701863170941;-0.105765752360637;0.0259065944045968]*... % Insertion of adductor brevis (mid) 1
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,10	)  = inv(Segment(5).B) *...
    [-0.012780658801953;-0.118726571446114;0.0252773810597323]*... % Insertion of adductor brevis (mid) 2
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,11	)  = inv(Segment(5).B) *...
    [-0.0120600107922316;-0.131584989282643;0.0240642210590307]*... % Insertion of adductor brevis (dist) 1
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,12	)  = inv(Segment(5).B) *...
    [-0.0105238090982762;-0.144388888334715;0.0217685178073348]*... % Insertion of adductor brevis (dist) 2
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,13	)  = inv(Segment(5).B) *...
    [-0.00180518043911509;-0.175293430132131;0.0142728650275274]*... % Insertion of adductor longus 1
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,14	)  = inv(Segment(5).B) *...
    [-0.0014578984658807;-0.187537428162697;0.0119225655873383]*... % Insertion of adductor longus 2
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,15	)  = inv(Segment(5).B) *...
    [-0.000599903922252806;-0.200028533691925;0.0102032261732582]*... % Insertion of adductor longus 3
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,16	)  = inv(Segment(5).B) *...
    [0.000468388856810049;-0.212640410394763;0.00871013656757064]*... % Insertion of adductor longus 4
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,17	)  = inv(Segment(5).B) *...
    [0.00114797086126407;-0.225112591946639;0.00685733986089576]*... % Insertion of adductor longus 5
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,18	)  = inv(Segment(5).B) *...
    [0.00108201701276152;-0.23740723039285;0.00437792146804396]*... % Insertion of adductor longus 6
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,19	)  = inv(Segment(5).B) *...
    [-0.00929777535851865;-0.366557958411902;-0.0352014843192834]*... % Insertion of adductor magnus (dist) 1&2&3
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,20	)  = inv(Segment(5).B) *...
    [-0.00372607504112845;-0.200165938758445;0.0116654758042045]*... % Insertion of adductor magnus (mid) 1&2
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,21	)  = inv(Segment(5).B) *...
    [-0.00245028197139381;-0.23176325572413;0.00510484225147064]*... % Insertion of adductor magnus (mid) 3&4
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,22	)  = inv(Segment(5).B) *...
    [-0.000241876944549699;-0.263562580299706;0.00198941230128373]*... % Insertion of adductor magnus (mid) 5&6
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,23	)  = inv(Segment(5).B) *...
    [-0.00695645103099705;-0.106963060218499;0.0174359266386106]*... % Insertion of adductor magnus (prox) 1
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,24	)  = inv(Segment(5).B) *...
    [-0.00511596767584963;-0.127663207363435;0.0156368910087716]*... % Insertion of adductor magnus (prox) 2
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,25	)  = inv(Segment(5).B) *...
    [-0.00328865667420293;-0.148462419128911;0.0138414176900682]*... % Insertion of adductor magnus (prox) 3
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,26	)  = inv(Segment(5).B) *...
    [-0.00153646975870579;-0.169149207447935;0.0120873851769583]*... % Insertion of adductor magnus (prox) 4
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,27	)  = inv(Segment(5).B) *...
    [-0.0123920357163218;-0.192957368549124;0.0200766375024061]*... % Origin of biceps femoris CB 1
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,28	)  = inv(Segment(5).B) *...
    [-0.00937028414741293;-0.238861803381979;0.0123002707330229]*... % Origin of biceps femoris CB 2
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,29	)  = inv(Segment(5).B) *...
    [-0.00686605899137448;-0.287845515305025;0.012422018866185]*... % Origin of biceps femoris CB 3
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,30	)  = inv(Segment(5).B) *...
    [-0.00948212666778091;-0.379165969058209;0.0177315307293361]*... % Origin of gastrocnemius (lat)
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,31	)  = inv(Segment(5).B) *...
    [-0.0105228954821142;-0.369987249053261;-0.0228103969424689]*... % Origin of gastrocnemius (med)
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,32	)  = inv(Segment(5).B) *...
    [-0.00848017052459722;0.00947745290181008;0.0525435495029383]*... % Insertion of gemelus (inf)
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,33	)  = inv(Segment(5).B) *...
    [-0.00202702249682998;0.000594818653104811;0.0427320414977715]*... % Insertion of gemelus (sup)
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,34	)  = inv(Segment(5).B) *...
    [0.00549484304875289;0.0597852153130726;0.0828057046938139]*... % Insertion of gluteus maximus (sup) 1
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,35	)  = inv(Segment(5).B) *...
    [0.000283493997045463;0.0296579355626409;0.0875236338900292]*... % Insertion of gluteus maximus (sup) 2
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,36	)  = inv(Segment(5).B) *...
    [-0.00634241774893979;-0.000263396647675917;0.0927381494278591]*... % Insertion of gluteus maximus (sup) 3
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,37	)  = inv(Segment(5).B) *...
    [0.0208627176574498;0.0550426228056364;0.0779234668544846]*... % Insertion of gluteus maximus (sup) 4
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,38	)  = inv(Segment(5).B) *...
    [0.0163013293795554;0.0247199840775638;0.0824191667493929]*... % Insertion of gluteus maximus (sup) 5
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,39	)  = inv(Segment(5).B) *...
    [0.00902545685975713;-0.00500598915511208;0.0878559115885298]*... % Insertion of gluteus maximus (sup) 6
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,40	)  = inv(Segment(5).B) *...
    [-0.0406270814972664;-0.0645684752877772;0.0641140565556898]*... % Insertion of gluteus maximus (inf) 1
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,41	)  = inv(Segment(5).B) *...
    [-0.0390265096571218;-0.07817827475464;0.0592951844618988]*... % Insertion of gluteus maximus (inf) 2
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,42	)  = inv(Segment(5).B) *...
    [-0.0312866731662827;-0.102842841251164;0.0504711213029207]*... % Insertion of gluteus maximus (inf) 3
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,43	)  = inv(Segment(5).B) *...
    [-0.0406270814972664;-0.0645684752877772;0.0641140565556898]*... % Insertion of gluteus maximus (inf) 4
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,44	)  = inv(Segment(5).B) *...
    [-0.0390265096571218;-0.07817827475464;0.0592951844618988]*... % Insertion of gluteus maximus (inf) 5
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,45	)  = inv(Segment(5).B) *...
    [-0.0312866731662827;-0.102842841251164;0.0504711213029207]*... % Insertion of gluteus maximus (inf) 6
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,46	)  = inv(Segment(5).B) *...
    [-0.000498880692093682;-0.0000706109369616878;0.0663708228979469]*... % Insertion of gluteus medius (ant) 1
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,47	)  = inv(Segment(5).B) *...
    [0.00744465032720686;-0.00307552184419718;0.0655159396398425]*... % Insertion of gluteus medius (ant) 2
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,48	)  = inv(Segment(5).B) *...
    [0.0147066055915413;-0.00509200275678851;0.0643636330539203]*...% Insertion of gluteus medius (ant) 3
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,49	)  = inv(Segment(5).B) *...
    [-0.00316739940175884;-0.00803467507878576;0.0708320660252691]*... % Insertion of gluteus medius (ant) 4
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,50	)  = inv(Segment(5).B) *...
    [0.0039187817923558;-0.0131048974088114;0.071130196212076]*... % Insertion of gluteus medius (ant) 5
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,51	)  = inv(Segment(5).B) *...
    [0.0111807370566903;-0.0151213783214027;0.0699778896261538]*... % Insertion of gluteus medius (ant) 6
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,52	)  = inv(Segment(5).B) *...
    [-0.0125588397644878;0.0126086755095321;0.0571663086587305]*... % Insertion of gluteus medius (post) 1
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,53	)  = inv(Segment(5).B) *...
    [-0.0163860041432689;0.012771763996192;0.0531642823015824]*... % Insertion of gluteus medius (post) 2
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,54	)  = inv(Segment(5).B) *...
    [-0.0201255775318954;0.0121857609369607;0.0511119199345408]*... % Insertion of gluteus medius (post) 3
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,55	)  = inv(Segment(5).B) *...
    [-0.0125588397644878;0.0126086755095321;0.0571663086587305]*... % Insertion of gluteus medius (post) 4
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,56	)  = inv(Segment(5).B) *...
    [-0.0183109213067525;0.00859167040175172;0.0617387508831008]*... % Insertion of gluteus medius (post) 5
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,57	)  = inv(Segment(5).B) *...
    [-0.0221314304858963;0.00772684340556586;0.0600547722969108]*... % Insertion of gluteus medius (post) 6
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,58	)  = inv(Segment(5).B) *...
    [0.0115211684610625;-0.0221979116191321;0.062524918208991]*... % Insertion of gluteus minimus (ant.mid.post)
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,59	)  = inv(Segment(5).B) *...
    [-0.0257384640293436;-0.0476980757545013;0.0156561501886013]*... % Insertion of illiacus (lat.mid.med)
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,60	)  = inv(Segment(5).B) *...
    [-0.0345498018980033;-0.0496411015930014;0.0469416895887019]*... % Insertion of obturator exterior (inf) 1&2
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,61	)  = inv(Segment(5).B) *...
    [-0.0140;-0.0310;0.0128]*... %	Via 1 of obturator exterior (sup) 1&2&3
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,62	)  = inv(Segment(5).B) *...
    [-0.00529774473053874;0.00504281519041328;0.0476602970587195]*... % Insertion of obturator interior  1&2&3
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,63	)  = inv(Segment(5).B) *...
    [-0.019053975289033;-0.0739909046015695;0.0250212322223819]*... % Insertion of pectineus 1
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,64	)  = inv(Segment(5).B) *...
    [-0.0187421689594285;-0.0828260503788081;0.0247003336281794]*... % Insertion of pectineus 2
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,65	)  = inv(Segment(5).B) *...
    [-0.0184303626298241;-0.0916611961560467;0.024379435033977]*... % Insertion of pectineus 3
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,66	)  = inv(Segment(5).B) *...
    [-0.019053975289033;-0.0739909046015695;0.0250212322223819]*... % Insertion of pectineus 4
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,67	)  = inv(Segment(5).B) *...
    [-0.0172220882555034;0.0126041322774939;0.0397966773192322]*... % Insertion of piriformis
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,68	)  = inv(Segment(5).B) *...
    [-0.00903756717706461;-0.38710881913824;0.0342939429771148]*... % Origin of plantaris
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,69	)  = inv(Segment(5).B) *...
    [-0.00964822231319559;-0.411569962112448;0.042356795121367]*... % Origin of popliteus 1&2
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,70	)  = inv(Segment(5).B) *...
    [0.00807663864682386;-0.0196340143389289;-0.0136562582396264]*... % Insertion of psoas minor
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,71	)  = inv(Segment(5).B) *...
    [-0.0257384640293436;-0.0476980757545013;0.0156561501886013]*... % Insertion of psoas major 1&2&3
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,72	)  = inv(Segment(5).B) *...
    [-0.0315974143549892;-0.0186427525194371;0.0468657783950949]*... % Insertion of quadratis femoris 1
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,73	)  = inv(Segment(5).B) *...
    [-0.0319261997847232;-0.0265523471259311;0.0474575666191388]*... % Insertion of quadratis femoris 2
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,74	)  = inv(Segment(5).B) *...
    [-0.0321666887748069;-0.0344753005583366;0.0480043517264536]*... % Insertion of quadratis femoris 3
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,75	)  = inv(Segment(5).B) *...
    [-0.0324071777648906;-0.0423982539907422;0.0485511368337683]*... % Insertion of quadratis femoris 4
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,76	)  = inv(Segment(5).B) *...
    [0.0284049269701265;-0.10782000735424;-0.0300334170209366]*... % Via point sartorius (prox) 1
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,77	)  = inv(Segment(5).B) *...
    [-0.011970486706894;-0.326057174816459;-0.0444682605766095]*... % Via point sartorius (prox) 13
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,78	)  = inv(Segment(5).B) *...
    [-0.0415683275625221;-0.372350000583308;-0.0376902004407696]*... % Via point sartorius (dist) 1
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,79	)  = inv(Segment(5).B) *...
    [0.0291461764374348;-0.234398404179956;0.0065504592944405]*... % Origin of vastus intermedialis 1
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,80	)  = inv(Segment(5).B) *...
    [0.0230775192847441;-0.178545682471384;0.0158394246893589]*... % Origin of vastus intermedialis 2
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,81	)  = inv(Segment(5).B) *...
    [0.0157835972989274;-0.118813225286451;0.0302388087287883]*... % Origin of vastus intermedialis 3
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,82	)  = inv(Segment(5).B) *...
    [0.0272376608989998;-0.236847058501142;0.018420659817384]*... % Origin of vastus intermedialis 4
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,83	)  = inv(Segment(5).B) *...
    [0.0208414572452138;-0.181478504967825;0.0298771801637838]*... % Origin of vastus intermedialis 5
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,84	)  = inv(Segment(5).B) *...
    [0.0140575683538005;-0.121220707336809;0.0411215866029245]*... % Origin of vastus intermedialis 6
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,85	)  = inv(Segment(5).B) *...
    [-0.00502613963234593;-0.294159487420413;0.0176840007056028]*... % Origin of vastus lateralis (inf) 1
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,86	)  = inv(Segment(5).B) *...
    [-0.00428544711877749;-0.248286338095984;0.018852566347289]*... % Origin of vastus lateralis (inf) 2
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,87	)  = inv(Segment(5).B) *...
    [-0.00541103798098799;-0.202959657093456;0.0231878903843139]*... % Origin of vastus lateralis (inf) 3
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,88	)  = inv(Segment(5).B) *...
    [-0.00834468181571492;-0.158083162368011;0.0307756407102041]*... % Origin of vastus lateralis (inf) 4
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,89	)  = inv(Segment(5).B) *...
    [-0.013099550976459;-0.113755918540187;0.0416193796360951]*... % Origin of vastus lateralis (inf) 5
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,90	)  = inv(Segment(5).B) *...
    [-0.0195741766700692;-0.0698922198153578;0.055670541734122]*... % Origin of vastus lateralis (inf) 6
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,91	)  = inv(Segment(5).B) *...
    [-0.000374663954515655;-0.0310333775157013;0.0675839411908565]*... % Origin of vastus lateralis (sup) 1
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,92	)  = inv(Segment(5).B) *...
    [0.0131825251949467;-0.0161829186462436;0.0506665982040797]*... % Origin of vastus lateralis (sup) 2
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,93	)  = inv(Segment(5).B) *...
    [0.0014327327137094;-0.297326501831753;-0.00159015265416191]*... % Origin of vastus medialis (inf) 1
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,94	)  = inv(Segment(5).B) *...
    [0.0113805417687401;-0.296697245726045;-0.00625760718078312]*... % Origin of vastus medialis (inf) 2
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,95	)  = inv(Segment(5).B) *...
    [0.00517783929197141;-0.252025491937083;0.00319865505136276]*... % Origin of vastus medialis (mid) 1
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,96	)  = inv(Segment(5).B) *...
    [0.0148926447243124;-0.251458006549899;-0.00124099760927304]*... % Origin of vastus medialis (mid) 2
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,97	)  = inv(Segment(5).B) *...
    [0.00477042411009388;-0.199701359423767;0.0110878355917289]*... % Origin of vastus medialis (sup) 1
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,98	)  = inv(Segment(5).B) *...
    [0.0136191588288191;-0.199208991268737;0.00697110539926557]*... % Origin of vastus medialis (sup) 2
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,99	)  = inv(Segment(5).B) *...
    [0.0017705264820971;-0.146887973762753;0.0201893140014453]*... % Origin of vastus medialis (sup) 3
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,100	)  = inv(Segment(5).B) *...
    [0.0106192612008223;-0.146395605607723;0.016072583808982]*... % Origin of vastus medialis (sup) 4
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,101	)  = inv(Segment(5).B) *...
    [0.00216987215774328;-0.0800730980093205;0.02980403714279]*... % Origin of vastus medialis (sup) 5
    (Segment(5).L/Model.Lm(5));
Segment(5).nV(:,102	)  = inv(Segment(5).B) *...
    [0.00674830337152556;-0.0798522402957688;0.0276110507107688]*... % Origin of vastus medialis (sup) 6
    (Segment(5).L/Model.Lm(5));

%--------------------------------------------------------------------------
% Pelvis (i = 6)
% Virtual markers start at 2 (other is for hip joint)
Segment(6).nV(:,2	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([	0.1000;   -0.0926  ;  0.0205	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of adductor brevis (prox) 1
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,3	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([	0.1045 ;  -0.0928  ;  0.0185	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of adductor brevis (prox) 2
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,4	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([ 0.0995 ;  -0.0978  ;  0.0136	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of adductor brevis (mid) 1
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,5	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.1031  ; -0.0980  ;  0.0119	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of adductor brevis (mid) 2
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,6	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0924   ;-0.1053  ;  0.0063	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of adductor brevis (dist) 1
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,7	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0947  ; -0.1054  ;  0.0052	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of adductor brevis (dist) 2
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,8	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.1063  ; -0.0888  ;  0.0233	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of adductor longus 1
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,9	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.1082 ;  -0.0912  ;  0.0208	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of adductor longus 2
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,10	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.1095  ; -0.0933  ;  0.0178	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of adductor longus 3
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,11	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.1101   ;-0.0952  ;  0.0146	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of adductor longus 4
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,12	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.1099  ; -0.0969  ;  0.0112	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of adductor longus 5
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,13	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.1088 ;  -0.0984  ;  0.0077	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of adductor longus 6
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,14	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0328  ; -0.1506  ;  0.0412	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of adductor magnus (dist) 1
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,15	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0387  ; -0.1467  ;  0.0340	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of adductor magnus (dist) 2
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,16	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0559  ; -0.1374  ;  0.0194	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of adductor magnus (dist) 3
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,17	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0259  ; -0.1486  ;  0.0403	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of adductor magnus (mid) 1
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,18	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0288  ; -0.1464  ;  0.0444	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of adductor magnus (mid) 2
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,19	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0326  ; -0.1456  ;  0.0344	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of adductor magnus (mid) 3
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,20	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0351  ; -0.1438  ;  0.0379	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of adductor magnus (mid) 4
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,21	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0413  ; -0.1417  ;  0.0273	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of adductor magnus (mid) 5
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,22	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0432  ; -0.1403  ;  0.0299	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of adductor magnus (mid) 6
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,23	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0724  ; -0.1246  ;  0.0123	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of adductor magnus (prox) 1
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,24	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0577  ; -0.1329  ;  0.0221	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of adductor magnus (prox) 2
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,25	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0651  ; -0.1288  ;  0.0172	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of adductor magnus (prox) 3
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,26	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0724  ; -0.1246  ;  0.0123	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of adductor magnus (prox) 4
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,27	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0160  ; -0.1405  ;  0.0726	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of biceps femoris CL
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,28	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([-0.0112  ; -0.1201  ;  0.0611	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gemelus (inf)
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,29	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([-0.0018  ; -0.0710  ;  0.0395	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gemelus (sup)
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,30	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([-0.0253  ; -0.0019  ;  0.0740	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gluteus maximus (sup) 1
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,31	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([-0.0360  ; -0.0245  ;  0.0551	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gluteus maximus (sup) 2
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,32	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([-0.0426  ; -0.0523  ;  0.0396	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gluteus maximus (sup) 3
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,33	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([-0.0375  ;  0.0095  ;  0.0629	]-[5.3771;-7.9600;8.9700]/100)*... %  Origin of gluteus maximus (sup) 4
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,34	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([-0.0495  ; -0.0119  ;  0.0428	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gluteus maximus (sup) 5
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,35	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([-0.0556  ; -0.0402  ;  0.0278	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gluteus maximus (sup) 6
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,36	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([-0.0536  ; -0.0879  ;  0.0145	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gluteus maximus (inf) 1
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,37	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([-0.0449  ; -0.0945  ;  0.0166	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gluteus maximus (inf) 2
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,38	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([-0.0367  ; -0.1052  ;  0.0162	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gluteus maximus (inf) 3
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,39	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([-0.0487  ; -0.0812  ;  0.0211	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gluteus maximus (inf) 4
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,40	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([-0.0400  ; -0.0878  ;  0.0232	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gluteus maximus (inf) 5
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,41	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([-0.0327  ; -0.0996  ;  0.0217	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gluteus maximus (inf) 6
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,42	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0578  ;  0.0152  ;  0.1343	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gluteus medius (ant) 1
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,43	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0681  ;  0.0107  ;  0.1353	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gluteus medius (ant) 2
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,44	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0787  ;  0.0023  ;  0.1323	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gluteus medius (ant) 3
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,45	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0631  ;  0.0199 ;   0.1419	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gluteus medius (ant) 4
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,46	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0718  ;  0.0140  ;  0.1406	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gluteus medius (ant) 5
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,47	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0819  ;  0.0051  ;  0.1369	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gluteus medius (ant) 6
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,48	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0150  ;  0.0391  ;  0.1148	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gluteus medius (post) 1
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,49	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([-0.0064  ;  0.0219  ;  0.0856	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gluteus medius (post) 2
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,50	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([-0.0144  ; -0.0075  ;  0.0666	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gluteus medius (post) 3
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,51	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0057  ;  0.0550  ;  0.1104	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gluteus medius (post) 4
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,52	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([-0.0196  ;  0.0445  ;  0.0794	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gluteus medius (post) 5
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,53	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([-0.0303  ;  0.0197  ;  0.0591	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gluteus medius (post) 6
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,54	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0530  ; -0.0007  ;  0.1228	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gluteus minimus (ant)
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,55	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0312  ; -0.0041  ;  0.1070	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gluteus minimus (mid)
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,56	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0135  ; -0.0145  ;  0.0904	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of Ggluteus minimus (post)
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,57	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0703  ; -0.1284  ;  0.0158	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gracilis 1
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,58	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0905  ; -0.1142  ;  0.0099	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of gracilis 2
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,59	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0768  ; -0.0476  ;  0.0787	]-[5.3771;-7.9600;8.9700]/100)*... % Via 1 of iIlliacus (lat.mid.med)
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,60	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0534  ; -0.1279  ;  0.0222	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of obturator exterior (inf) 1
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,61	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0727  ; -0.1191  ;  0.0099	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of obturator exterior (inf) 2
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,62	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0926  ; -0.0973  ;  0.0095	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of obturator exterior (sup) 1
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,63	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0749  ; -0.1122  ;  0.0125	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of obturator exterior (sup) 2
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,64	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0534  ; -0.1229  ;  0.0210	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of obturator exterior (sup) 3
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,65	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([-0.0032  ; -0.1046  ;  0.0467	]-[5.3771;-7.9600;8.9700]/100)*... % Via 1 of obturator interior 1&2&3
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,66	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0885  ; -0.0658  ;  0.0384	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of pectineus 1
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,67	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0935  ; -0.0693  ;  0.0349	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of pectineus 2
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,68	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0985  ; -0.0729  ;  0.0314	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of pectineus 3
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,69	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.1035  ; -0.0764  ;  0.0279	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of pectineus 4
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,70	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([-0.0469  ; -0.0565  ;  0.0155	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of piriformis
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,71	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0032  ;  0.1732  ;  0.0336	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of psoas minor
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,72	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0768  ; -0.0476  ;  0.0787	]-[5.3771;-7.9600;8.9700]/100)*... % Via 1 of psoas major 1&2&3
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,73	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0448  ; -0.1294  ;  0.0267	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of quadratis femoris 1
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,74	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0384  ; -0.1320  ;  0.0347	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of quadratis femoris 2
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,75	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0321  ; -0.1346  ;  0.0428	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of quadratis femoris 3
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,76	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0258  ; -0.1372  ;  0.0508	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of quadratis femoris 4
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,77	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0840  ; -0.0369  ;  0.1100	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of rectus femoris 1&2
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,78	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0858  ; -0.0047  ;  0.1247	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of sartorius (prox.dist)
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,79	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0258  ; -0.1457  ;  0.0694	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of semimembranosus
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,80	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0135  ; -0.1403  ;  0.0619	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of semitendinus
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,81	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0821  ;  0.0003  ;  0.1373	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of tensor facie late 1
    (Segment(6).L/Model.Lm(6));
Segment(6).nV(:,82	)=Segment(6).nV(:,1)+inv(Segment(6).B) *...
    ([0.0775  ;  0.0105  ;  0.1410	]-[5.3771;-7.9600;8.9700]/100)*... % Origin of tensor facie late 2
    (Segment(6).L/Model.Lm(6));

% ------------------------------------------------------------------------
% Interpolation matrices
% -------------------------------------------------------------------------
% Foot (i = 2)
NV42 = [Segment(2).nV(1,4)*eye(3),(1 + Segment(2).nV(2,4))*eye(3), - Segment(2).nV(2,4)*eye(3), Segment(2).nV(3,4)*eye(3)];
NV52 = [Segment(2).nV(1,5)*eye(3),(1 + Segment(2).nV(2,5))*eye(3), - Segment(2).nV(2,5)*eye(3), Segment(2).nV(3,5)*eye(3)];
NV62 = [Segment(2).nV(1,6)*eye(3),(1 + Segment(2).nV(2,6))*eye(3), - Segment(2).nV(2,6)*eye(3), Segment(2).nV(3,6)*eye(3)];
NV72 = [Segment(2).nV(1,7)*eye(3),(1 + Segment(2).nV(2,7))*eye(3), - Segment(2).nV(2,7)*eye(3), Segment(2).nV(3,7)*eye(3)];
NV82 = [Segment(2).nV(1,8)*eye(3),(1 + Segment(2).nV(2,8))*eye(3), - Segment(2).nV(2,8)*eye(3), Segment(2).nV(3,8)*eye(3)];
NV92 = [Segment(2).nV(1,9)*eye(3),(1 + Segment(2).nV(2,9))*eye(3), - Segment(2).nV(2,9)*eye(3), Segment(2).nV(3,9)*eye(3)];
NV102 = [Segment(2).nV(1,10)*eye(3),(1 + Segment(2).nV(2,10))*eye(3), - Segment(2).nV(2,10)*eye(3), Segment(2).nV(3,10)*eye(3)];
NV112 = [Segment(2).nV(1,11)*eye(3),(1 + Segment(2).nV(2,11))*eye(3), - Segment(2).nV(2,11)*eye(3), Segment(2).nV(3,11)*eye(3)];
NV122 = [Segment(2).nV(1,12)*eye(3),(1 + Segment(2).nV(2,12))*eye(3), - Segment(2).nV(2,12)*eye(3), Segment(2).nV(3,12)*eye(3)];
NV132 = [Segment(2).nV(1,13)*eye(3),(1 + Segment(2).nV(2,13))*eye(3), - Segment(2).nV(2,13)*eye(3), Segment(2).nV(3,13)*eye(3)];
NV142 = [Segment(2).nV(1,14)*eye(3),(1 + Segment(2).nV(2,14))*eye(3), - Segment(2).nV(2,14)*eye(3), Segment(2).nV(3,14)*eye(3)];
NV152 = [Segment(2).nV(1,15)*eye(3),(1 + Segment(2).nV(2,15))*eye(3), - Segment(2).nV(2,15)*eye(3), Segment(2).nV(3,15)*eye(3)];
NV162 = [Segment(2).nV(1,16)*eye(3),(1 + Segment(2).nV(2,16))*eye(3), - Segment(2).nV(2,16)*eye(3), Segment(2).nV(3,16)*eye(3)];
NV172 = [Segment(2).nV(1,17)*eye(3),(1 + Segment(2).nV(2,17))*eye(3), - Segment(2).nV(2,17)*eye(3), Segment(2).nV(3,17)*eye(3)];

% Shank (i = 3)
NV103 = [Segment(3).nV(1,10)*eye(3),(1 + Segment(3).nV(2,10))*eye(3), - Segment(3).nV(2,10)*eye(3), Segment(3).nV(3,10)*eye(3)];
NV113 = [Segment(3).nV(1,11)*eye(3),(1 + Segment(3).nV(2,11))*eye(3), - Segment(3).nV(2,11)*eye(3), Segment(3).nV(3,11)*eye(3)];
NV123 = [Segment(3).nV(1,12)*eye(3),(1 + Segment(3).nV(2,12))*eye(3), - Segment(3).nV(2,12)*eye(3), Segment(3).nV(3,12)*eye(3)];
NV133 = [Segment(3).nV(1,13)*eye(3),(1 + Segment(3).nV(2,13))*eye(3), - Segment(3).nV(2,13)*eye(3), Segment(3).nV(3,13)*eye(3)];
NV143 = [Segment(3).nV(1,14)*eye(3),(1 + Segment(3).nV(2,14))*eye(3), - Segment(3).nV(2,14)*eye(3), Segment(3).nV(3,14)*eye(3)];
NV153 = [Segment(3).nV(1,15)*eye(3),(1 + Segment(3).nV(2,15))*eye(3), - Segment(3).nV(2,15)*eye(3), Segment(3).nV(3,15)*eye(3)];
NV163 = [Segment(3).nV(1,16)*eye(3),(1 + Segment(3).nV(2,16))*eye(3), - Segment(3).nV(2,16)*eye(3), Segment(3).nV(3,16)*eye(3)];
NV173 = [Segment(3).nV(1,17)*eye(3),(1 + Segment(3).nV(2,17))*eye(3), - Segment(3).nV(2,17)*eye(3), Segment(3).nV(3,17)*eye(3)];
NV183 = [Segment(3).nV(1,18)*eye(3),(1 + Segment(3).nV(2,18))*eye(3), - Segment(3).nV(2,18)*eye(3), Segment(3).nV(3,18)*eye(3)];
NV193 = [Segment(3).nV(1,19)*eye(3),(1 + Segment(3).nV(2,19))*eye(3), - Segment(3).nV(2,19)*eye(3), Segment(3).nV(3,19)*eye(3)];
NV203 = [Segment(3).nV(1,20)*eye(3),(1 + Segment(3).nV(2,20))*eye(3), - Segment(3).nV(2,20)*eye(3), Segment(3).nV(3,20)*eye(3)];
NV213 = [Segment(3).nV(1,21)*eye(3),(1 + Segment(3).nV(2,21))*eye(3), - Segment(3).nV(2,21)*eye(3), Segment(3).nV(3,21)*eye(3)];
NV223 = [Segment(3).nV(1,22)*eye(3),(1 + Segment(3).nV(2,22))*eye(3), - Segment(3).nV(2,22)*eye(3), Segment(3).nV(3,22)*eye(3)];
NV233 = [Segment(3).nV(1,23)*eye(3),(1 + Segment(3).nV(2,23))*eye(3), - Segment(3).nV(2,23)*eye(3), Segment(3).nV(3,23)*eye(3)];
NV243 = [Segment(3).nV(1,24)*eye(3),(1 + Segment(3).nV(2,24))*eye(3), - Segment(3).nV(2,24)*eye(3), Segment(3).nV(3,24)*eye(3)];
NV253 = [Segment(3).nV(1,25)*eye(3),(1 + Segment(3).nV(2,25))*eye(3), - Segment(3).nV(2,25)*eye(3), Segment(3).nV(3,25)*eye(3)];
NV263 = [Segment(3).nV(1,26)*eye(3),(1 + Segment(3).nV(2,26))*eye(3), - Segment(3).nV(2,26)*eye(3), Segment(3).nV(3,26)*eye(3)];
NV273 = [Segment(3).nV(1,27)*eye(3),(1 + Segment(3).nV(2,27))*eye(3), - Segment(3).nV(2,27)*eye(3), Segment(3).nV(3,27)*eye(3)];
NV283 = [Segment(3).nV(1,28)*eye(3),(1 + Segment(3).nV(2,28))*eye(3), - Segment(3).nV(2,28)*eye(3), Segment(3).nV(3,28)*eye(3)];
NV293 = [Segment(3).nV(1,29)*eye(3),(1 + Segment(3).nV(2,29))*eye(3), - Segment(3).nV(2,29)*eye(3), Segment(3).nV(3,29)*eye(3)];
NV303 = [Segment(3).nV(1,30)*eye(3),(1 + Segment(3).nV(2,30))*eye(3), - Segment(3).nV(2,30)*eye(3), Segment(3).nV(3,30)*eye(3)];

% Patella (i = 4)
NV24 = [Segment(4).nV(1,2)*eye(3),(1 + Segment(4).nV(2,2))*eye(3), - Segment(4).nV(2,2)*eye(3), Segment(4).nV(3,2)*eye(3)];
NV34 = [Segment(4).nV(1,3)*eye(3),(1 + Segment(4).nV(2,3))*eye(3), - Segment(4).nV(2,3)*eye(3), Segment(4).nV(3,3)*eye(3)];

% Thigh (i = 5)
NV75 = [Segment(5).nV(1,7)*eye(3),(1 + Segment(5).nV(2,7))*eye(3), - Segment(5).nV(2,7)*eye(3), Segment(5).nV(3,7)*eye(3)];
NV85 = [Segment(5).nV(1,8)*eye(3),(1 + Segment(5).nV(2,8))*eye(3), - Segment(5).nV(2,8)*eye(3), Segment(5).nV(3,8)*eye(3)];
NV95 = [Segment(5).nV(1,9)*eye(3),(1 + Segment(5).nV(2,9))*eye(3), - Segment(5).nV(2,9)*eye(3), Segment(5).nV(3,9)*eye(3)];
NV105 = [Segment(5).nV(1,10)*eye(3),(1 + Segment(5).nV(2,10))*eye(3), - Segment(5).nV(2,10)*eye(3), Segment(5).nV(3,10)*eye(3)];
NV115 = [Segment(5).nV(1,11)*eye(3),(1 + Segment(5).nV(2,11))*eye(3), - Segment(5).nV(2,11)*eye(3), Segment(5).nV(3,11)*eye(3)];
NV125 = [Segment(5).nV(1,12)*eye(3),(1 + Segment(5).nV(2,12))*eye(3), - Segment(5).nV(2,12)*eye(3), Segment(5).nV(3,12)*eye(3)];
NV135 = [Segment(5).nV(1,13)*eye(3),(1 + Segment(5).nV(2,13))*eye(3), - Segment(5).nV(2,13)*eye(3), Segment(5).nV(3,13)*eye(3)];
NV145 = [Segment(5).nV(1,14)*eye(3),(1 + Segment(5).nV(2,14))*eye(3), - Segment(5).nV(2,14)*eye(3), Segment(5).nV(3,14)*eye(3)];
NV155 = [Segment(5).nV(1,15)*eye(3),(1 + Segment(5).nV(2,15))*eye(3), - Segment(5).nV(2,15)*eye(3), Segment(5).nV(3,15)*eye(3)];
NV165 = [Segment(5).nV(1,16)*eye(3),(1 + Segment(5).nV(2,16))*eye(3), - Segment(5).nV(2,16)*eye(3), Segment(5).nV(3,16)*eye(3)];
NV175 = [Segment(5).nV(1,17)*eye(3),(1 + Segment(5).nV(2,17))*eye(3), - Segment(5).nV(2,17)*eye(3), Segment(5).nV(3,17)*eye(3)];
NV185 = [Segment(5).nV(1,18)*eye(3),(1 + Segment(5).nV(2,18))*eye(3), - Segment(5).nV(2,18)*eye(3), Segment(5).nV(3,18)*eye(3)];
NV195 = [Segment(5).nV(1,19)*eye(3),(1 + Segment(5).nV(2,19))*eye(3), - Segment(5).nV(2,19)*eye(3), Segment(5).nV(3,19)*eye(3)];
NV205 = [Segment(5).nV(1,20)*eye(3),(1 + Segment(5).nV(2,20))*eye(3), - Segment(5).nV(2,20)*eye(3), Segment(5).nV(3,20)*eye(3)];
NV215 = [Segment(5).nV(1,21)*eye(3),(1 + Segment(5).nV(2,21))*eye(3), - Segment(5).nV(2,21)*eye(3), Segment(5).nV(3,21)*eye(3)];
NV225 = [Segment(5).nV(1,22)*eye(3),(1 + Segment(5).nV(2,22))*eye(3), - Segment(5).nV(2,22)*eye(3), Segment(5).nV(3,22)*eye(3)];
NV235 = [Segment(5).nV(1,23)*eye(3),(1 + Segment(5).nV(2,23))*eye(3), - Segment(5).nV(2,23)*eye(3), Segment(5).nV(3,23)*eye(3)];
NV245 = [Segment(5).nV(1,24)*eye(3),(1 + Segment(5).nV(2,24))*eye(3), - Segment(5).nV(2,24)*eye(3), Segment(5).nV(3,24)*eye(3)];
NV255 = [Segment(5).nV(1,25)*eye(3),(1 + Segment(5).nV(2,25))*eye(3), - Segment(5).nV(2,25)*eye(3), Segment(5).nV(3,25)*eye(3)];
NV265 = [Segment(5).nV(1,26)*eye(3),(1 + Segment(5).nV(2,26))*eye(3), - Segment(5).nV(2,26)*eye(3), Segment(5).nV(3,26)*eye(3)];
NV275 = [Segment(5).nV(1,27)*eye(3),(1 + Segment(5).nV(2,27))*eye(3), - Segment(5).nV(2,27)*eye(3), Segment(5).nV(3,27)*eye(3)];
NV285 = [Segment(5).nV(1,28)*eye(3),(1 + Segment(5).nV(2,28))*eye(3), - Segment(5).nV(2,28)*eye(3), Segment(5).nV(3,28)*eye(3)];
NV295 = [Segment(5).nV(1,29)*eye(3),(1 + Segment(5).nV(2,29))*eye(3), - Segment(5).nV(2,29)*eye(3), Segment(5).nV(3,29)*eye(3)];
NV305 = [Segment(5).nV(1,30)*eye(3),(1 + Segment(5).nV(2,30))*eye(3), - Segment(5).nV(2,30)*eye(3), Segment(5).nV(3,30)*eye(3)];
NV315 = [Segment(5).nV(1,31)*eye(3),(1 + Segment(5).nV(2,31))*eye(3), - Segment(5).nV(2,31)*eye(3), Segment(5).nV(3,31)*eye(3)];
NV325 = [Segment(5).nV(1,32)*eye(3),(1 + Segment(5).nV(2,32))*eye(3), - Segment(5).nV(2,32)*eye(3), Segment(5).nV(3,32)*eye(3)];
NV335 = [Segment(5).nV(1,33)*eye(3),(1 + Segment(5).nV(2,33))*eye(3), - Segment(5).nV(2,33)*eye(3), Segment(5).nV(3,33)*eye(3)];
NV345 = [Segment(5).nV(1,34)*eye(3),(1 + Segment(5).nV(2,34))*eye(3), - Segment(5).nV(2,34)*eye(3), Segment(5).nV(3,34)*eye(3)];
NV355 = [Segment(5).nV(1,35)*eye(3),(1 + Segment(5).nV(2,35))*eye(3), - Segment(5).nV(2,35)*eye(3), Segment(5).nV(3,35)*eye(3)];
NV365 = [Segment(5).nV(1,36)*eye(3),(1 + Segment(5).nV(2,36))*eye(3), - Segment(5).nV(2,36)*eye(3), Segment(5).nV(3,36)*eye(3)];
NV375 = [Segment(5).nV(1,37)*eye(3),(1 + Segment(5).nV(2,37))*eye(3), - Segment(5).nV(2,37)*eye(3), Segment(5).nV(3,37)*eye(3)];
NV385 = [Segment(5).nV(1,38)*eye(3),(1 + Segment(5).nV(2,38))*eye(3), - Segment(5).nV(2,38)*eye(3), Segment(5).nV(3,38)*eye(3)];
NV395 = [Segment(5).nV(1,39)*eye(3),(1 + Segment(5).nV(2,39))*eye(3), - Segment(5).nV(2,39)*eye(3), Segment(5).nV(3,39)*eye(3)];
NV405 = [Segment(5).nV(1,40)*eye(3),(1 + Segment(5).nV(2,40))*eye(3), - Segment(5).nV(2,40)*eye(3), Segment(5).nV(3,40)*eye(3)];
NV415 = [Segment(5).nV(1,41)*eye(3),(1 + Segment(5).nV(2,41))*eye(3), - Segment(5).nV(2,41)*eye(3), Segment(5).nV(3,41)*eye(3)];
NV425 = [Segment(5).nV(1,42)*eye(3),(1 + Segment(5).nV(2,42))*eye(3), - Segment(5).nV(2,42)*eye(3), Segment(5).nV(3,42)*eye(3)];
NV435 = [Segment(5).nV(1,43)*eye(3),(1 + Segment(5).nV(2,43))*eye(3), - Segment(5).nV(2,43)*eye(3), Segment(5).nV(3,43)*eye(3)];
NV445 = [Segment(5).nV(1,44)*eye(3),(1 + Segment(5).nV(2,44))*eye(3), - Segment(5).nV(2,44)*eye(3), Segment(5).nV(3,44)*eye(3)];
NV455 = [Segment(5).nV(1,45)*eye(3),(1 + Segment(5).nV(2,45))*eye(3), - Segment(5).nV(2,45)*eye(3), Segment(5).nV(3,45)*eye(3)];
NV465 = [Segment(5).nV(1,46)*eye(3),(1 + Segment(5).nV(2,46))*eye(3), - Segment(5).nV(2,46)*eye(3), Segment(5).nV(3,46)*eye(3)];
NV475 = [Segment(5).nV(1,47)*eye(3),(1 + Segment(5).nV(2,47))*eye(3), - Segment(5).nV(2,47)*eye(3), Segment(5).nV(3,47)*eye(3)];
NV485 = [Segment(5).nV(1,48)*eye(3),(1 + Segment(5).nV(2,48))*eye(3), - Segment(5).nV(2,48)*eye(3), Segment(5).nV(3,48)*eye(3)];
NV495 = [Segment(5).nV(1,49)*eye(3),(1 + Segment(5).nV(2,49))*eye(3), - Segment(5).nV(2,49)*eye(3), Segment(5).nV(3,49)*eye(3)];
NV505 = [Segment(5).nV(1,50)*eye(3),(1 + Segment(5).nV(2,50))*eye(3), - Segment(5).nV(2,50)*eye(3), Segment(5).nV(3,50)*eye(3)];
NV515 = [Segment(5).nV(1,51)*eye(3),(1 + Segment(5).nV(2,51))*eye(3), - Segment(5).nV(2,51)*eye(3), Segment(5).nV(3,51)*eye(3)];
NV525 = [Segment(5).nV(1,52)*eye(3),(1 + Segment(5).nV(2,52))*eye(3), - Segment(5).nV(2,52)*eye(3), Segment(5).nV(3,52)*eye(3)];
NV535 = [Segment(5).nV(1,53)*eye(3),(1 + Segment(5).nV(2,53))*eye(3), - Segment(5).nV(2,53)*eye(3), Segment(5).nV(3,53)*eye(3)];
NV545 = [Segment(5).nV(1,54)*eye(3),(1 + Segment(5).nV(2,54))*eye(3), - Segment(5).nV(2,54)*eye(3), Segment(5).nV(3,54)*eye(3)];
NV555 = [Segment(5).nV(1,55)*eye(3),(1 + Segment(5).nV(2,55))*eye(3), - Segment(5).nV(2,55)*eye(3), Segment(5).nV(3,55)*eye(3)];
NV565 = [Segment(5).nV(1,56)*eye(3),(1 + Segment(5).nV(2,56))*eye(3), - Segment(5).nV(2,56)*eye(3), Segment(5).nV(3,56)*eye(3)];
NV575 = [Segment(5).nV(1,57)*eye(3),(1 + Segment(5).nV(2,57))*eye(3), - Segment(5).nV(2,57)*eye(3), Segment(5).nV(3,57)*eye(3)];
NV585 = [Segment(5).nV(1,58)*eye(3),(1 + Segment(5).nV(2,58))*eye(3), - Segment(5).nV(2,58)*eye(3), Segment(5).nV(3,58)*eye(3)];
NV595 = [Segment(5).nV(1,59)*eye(3),(1 + Segment(5).nV(2,59))*eye(3), - Segment(5).nV(2,59)*eye(3), Segment(5).nV(3,59)*eye(3)];
NV605 = [Segment(5).nV(1,60)*eye(3),(1 + Segment(5).nV(2,60))*eye(3), - Segment(5).nV(2,60)*eye(3), Segment(5).nV(3,60)*eye(3)];
NV615 = [Segment(5).nV(1,61)*eye(3),(1 + Segment(5).nV(2,61))*eye(3), - Segment(5).nV(2,61)*eye(3), Segment(5).nV(3,61)*eye(3)];
NV625 = [Segment(5).nV(1,62)*eye(3),(1 + Segment(5).nV(2,62))*eye(3), - Segment(5).nV(2,62)*eye(3), Segment(5).nV(3,62)*eye(3)];
NV635 = [Segment(5).nV(1,63)*eye(3),(1 + Segment(5).nV(2,63))*eye(3), - Segment(5).nV(2,63)*eye(3), Segment(5).nV(3,63)*eye(3)];
NV645 = [Segment(5).nV(1,64)*eye(3),(1 + Segment(5).nV(2,64))*eye(3), - Segment(5).nV(2,64)*eye(3), Segment(5).nV(3,64)*eye(3)];
NV655 = [Segment(5).nV(1,65)*eye(3),(1 + Segment(5).nV(2,65))*eye(3), - Segment(5).nV(2,65)*eye(3), Segment(5).nV(3,65)*eye(3)];
NV665 = [Segment(5).nV(1,66)*eye(3),(1 + Segment(5).nV(2,66))*eye(3), - Segment(5).nV(2,66)*eye(3), Segment(5).nV(3,66)*eye(3)];
NV675 = [Segment(5).nV(1,67)*eye(3),(1 + Segment(5).nV(2,67))*eye(3), - Segment(5).nV(2,67)*eye(3), Segment(5).nV(3,67)*eye(3)];
NV685 = [Segment(5).nV(1,68)*eye(3),(1 + Segment(5).nV(2,68))*eye(3), - Segment(5).nV(2,68)*eye(3), Segment(5).nV(3,68)*eye(3)];
NV695 = [Segment(5).nV(1,69)*eye(3),(1 + Segment(5).nV(2,69))*eye(3), - Segment(5).nV(2,69)*eye(3), Segment(5).nV(3,69)*eye(3)];
NV705 = [Segment(5).nV(1,70)*eye(3),(1 + Segment(5).nV(2,70))*eye(3), - Segment(5).nV(2,70)*eye(3), Segment(5).nV(3,70)*eye(3)];
NV715 = [Segment(5).nV(1,71)*eye(3),(1 + Segment(5).nV(2,71))*eye(3), - Segment(5).nV(2,71)*eye(3), Segment(5).nV(3,71)*eye(3)];
NV725 = [Segment(5).nV(1,72)*eye(3),(1 + Segment(5).nV(2,72))*eye(3), - Segment(5).nV(2,72)*eye(3), Segment(5).nV(3,72)*eye(3)];
NV735 = [Segment(5).nV(1,73)*eye(3),(1 + Segment(5).nV(2,73))*eye(3), - Segment(5).nV(2,73)*eye(3), Segment(5).nV(3,73)*eye(3)];
NV745 = [Segment(5).nV(1,74)*eye(3),(1 + Segment(5).nV(2,74))*eye(3), - Segment(5).nV(2,74)*eye(3), Segment(5).nV(3,74)*eye(3)];
NV755 = [Segment(5).nV(1,75)*eye(3),(1 + Segment(5).nV(2,75))*eye(3), - Segment(5).nV(2,75)*eye(3), Segment(5).nV(3,75)*eye(3)];
NV765 = [Segment(5).nV(1,76)*eye(3),(1 + Segment(5).nV(2,76))*eye(3), - Segment(5).nV(2,76)*eye(3), Segment(5).nV(3,76)*eye(3)];
NV775 = [Segment(5).nV(1,77)*eye(3),(1 + Segment(5).nV(2,77))*eye(3), - Segment(5).nV(2,77)*eye(3), Segment(5).nV(3,77)*eye(3)];
NV785 = [Segment(5).nV(1,78)*eye(3),(1 + Segment(5).nV(2,78))*eye(3), - Segment(5).nV(2,78)*eye(3), Segment(5).nV(3,78)*eye(3)];
NV795 = [Segment(5).nV(1,79)*eye(3),(1 + Segment(5).nV(2,79))*eye(3), - Segment(5).nV(2,79)*eye(3), Segment(5).nV(3,79)*eye(3)];
NV805 = [Segment(5).nV(1,80)*eye(3),(1 + Segment(5).nV(2,80))*eye(3), - Segment(5).nV(2,80)*eye(3), Segment(5).nV(3,80)*eye(3)];
NV815 = [Segment(5).nV(1,81)*eye(3),(1 + Segment(5).nV(2,81))*eye(3), - Segment(5).nV(2,81)*eye(3), Segment(5).nV(3,81)*eye(3)];
NV825 = [Segment(5).nV(1,82)*eye(3),(1 + Segment(5).nV(2,82))*eye(3), - Segment(5).nV(2,82)*eye(3), Segment(5).nV(3,82)*eye(3)];
NV835 = [Segment(5).nV(1,83)*eye(3),(1 + Segment(5).nV(2,83))*eye(3), - Segment(5).nV(2,83)*eye(3), Segment(5).nV(3,83)*eye(3)];
NV845 = [Segment(5).nV(1,84)*eye(3),(1 + Segment(5).nV(2,84))*eye(3), - Segment(5).nV(2,84)*eye(3), Segment(5).nV(3,84)*eye(3)];
NV855 = [Segment(5).nV(1,85)*eye(3),(1 + Segment(5).nV(2,85))*eye(3), - Segment(5).nV(2,85)*eye(3), Segment(5).nV(3,85)*eye(3)];
NV865 = [Segment(5).nV(1,86)*eye(3),(1 + Segment(5).nV(2,86))*eye(3), - Segment(5).nV(2,86)*eye(3), Segment(5).nV(3,86)*eye(3)];
NV875 = [Segment(5).nV(1,87)*eye(3),(1 + Segment(5).nV(2,87))*eye(3), - Segment(5).nV(2,87)*eye(3), Segment(5).nV(3,87)*eye(3)];
NV885 = [Segment(5).nV(1,88)*eye(3),(1 + Segment(5).nV(2,88))*eye(3), - Segment(5).nV(2,88)*eye(3), Segment(5).nV(3,88)*eye(3)];
NV895 = [Segment(5).nV(1,89)*eye(3),(1 + Segment(5).nV(2,89))*eye(3), - Segment(5).nV(2,89)*eye(3), Segment(5).nV(3,89)*eye(3)];
NV905 = [Segment(5).nV(1,90)*eye(3),(1 + Segment(5).nV(2,90))*eye(3), - Segment(5).nV(2,90)*eye(3), Segment(5).nV(3,90)*eye(3)];
NV915 = [Segment(5).nV(1,91)*eye(3),(1 + Segment(5).nV(2,91))*eye(3), - Segment(5).nV(2,91)*eye(3), Segment(5).nV(3,91)*eye(3)];
NV925 = [Segment(5).nV(1,92)*eye(3),(1 + Segment(5).nV(2,92))*eye(3), - Segment(5).nV(2,92)*eye(3), Segment(5).nV(3,92)*eye(3)];
NV935 = [Segment(5).nV(1,93)*eye(3),(1 + Segment(5).nV(2,93))*eye(3), - Segment(5).nV(2,93)*eye(3), Segment(5).nV(3,93)*eye(3)];
NV945 = [Segment(5).nV(1,94)*eye(3),(1 + Segment(5).nV(2,94))*eye(3), - Segment(5).nV(2,94)*eye(3), Segment(5).nV(3,94)*eye(3)];
NV955 = [Segment(5).nV(1,95)*eye(3),(1 + Segment(5).nV(2,95))*eye(3), - Segment(5).nV(2,95)*eye(3), Segment(5).nV(3,95)*eye(3)];
NV965 = [Segment(5).nV(1,96)*eye(3),(1 + Segment(5).nV(2,96))*eye(3), - Segment(5).nV(2,96)*eye(3), Segment(5).nV(3,96)*eye(3)];
NV975 = [Segment(5).nV(1,97)*eye(3),(1 + Segment(5).nV(2,97))*eye(3), - Segment(5).nV(2,97)*eye(3), Segment(5).nV(3,97)*eye(3)];
NV985 = [Segment(5).nV(1,98)*eye(3),(1 + Segment(5).nV(2,98))*eye(3), - Segment(5).nV(2,98)*eye(3), Segment(5).nV(3,98)*eye(3)];
NV995 = [Segment(5).nV(1,99)*eye(3),(1 + Segment(5).nV(2,99))*eye(3), - Segment(5).nV(2,99)*eye(3), Segment(5).nV(3,99)*eye(3)];
NV1005 = [Segment(5).nV(1,100)*eye(3),(1 + Segment(5).nV(2,100))*eye(3), - Segment(5).nV(2,100)*eye(3), Segment(5).nV(3,100)*eye(3)];
NV1015 = [Segment(5).nV(1,101)*eye(3),(1 + Segment(5).nV(2,101))*eye(3), - Segment(5).nV(2,101)*eye(3), Segment(5).nV(3,101)*eye(3)];
NV1025 = [Segment(5).nV(1,102)*eye(3),(1 + Segment(5).nV(2,102))*eye(3), - Segment(5).nV(2,102)*eye(3), Segment(5).nV(3,102)*eye(3)];

% Pelvis (i = 6)
NV26 = [Segment(6).nV(1,2)*eye(3),(1 + Segment(6).nV(2,2))*eye(3), - Segment(6).nV(2,2)*eye(3), Segment(6).nV(3,2)*eye(3)];
NV36 = [Segment(6).nV(1,3)*eye(3),(1 + Segment(6).nV(2,3))*eye(3), - Segment(6).nV(2,3)*eye(3), Segment(6).nV(3,3)*eye(3)];
NV46 = [Segment(6).nV(1,4)*eye(3),(1 + Segment(6).nV(2,4))*eye(3), - Segment(6).nV(2,4)*eye(3), Segment(6).nV(3,4)*eye(3)];
NV56 = [Segment(6).nV(1,5)*eye(3),(1 + Segment(6).nV(2,5))*eye(3), - Segment(6).nV(2,5)*eye(3), Segment(6).nV(3,5)*eye(3)];
NV66 = [Segment(6).nV(1,6)*eye(3),(1 + Segment(6).nV(2,6))*eye(3), - Segment(6).nV(2,6)*eye(3), Segment(6).nV(3,6)*eye(3)];
NV76 = [Segment(6).nV(1,7)*eye(3),(1 + Segment(6).nV(2,7))*eye(3), - Segment(6).nV(2,7)*eye(3), Segment(6).nV(3,7)*eye(3)];
NV86 = [Segment(6).nV(1,8)*eye(3),(1 + Segment(6).nV(2,8))*eye(3), - Segment(6).nV(2,8)*eye(3), Segment(6).nV(3,8)*eye(3)];
NV96 = [Segment(6).nV(1,9)*eye(3),(1 + Segment(6).nV(2,9))*eye(3), - Segment(6).nV(2,9)*eye(3), Segment(6).nV(3,9)*eye(3)];
NV106 = [Segment(6).nV(1,10)*eye(3),(1 + Segment(6).nV(2,10))*eye(3), - Segment(6).nV(2,10)*eye(3), Segment(6).nV(3,10)*eye(3)];
NV116 = [Segment(6).nV(1,11)*eye(3),(1 + Segment(6).nV(2,11))*eye(3), - Segment(6).nV(2,11)*eye(3), Segment(6).nV(3,11)*eye(3)];
NV126 = [Segment(6).nV(1,12)*eye(3),(1 + Segment(6).nV(2,12))*eye(3), - Segment(6).nV(2,12)*eye(3), Segment(6).nV(3,12)*eye(3)];
NV136 = [Segment(6).nV(1,13)*eye(3),(1 + Segment(6).nV(2,13))*eye(3), - Segment(6).nV(2,13)*eye(3), Segment(6).nV(3,13)*eye(3)];
NV146 = [Segment(6).nV(1,14)*eye(3),(1 + Segment(6).nV(2,14))*eye(3), - Segment(6).nV(2,14)*eye(3), Segment(6).nV(3,14)*eye(3)];
NV156 = [Segment(6).nV(1,15)*eye(3),(1 + Segment(6).nV(2,15))*eye(3), - Segment(6).nV(2,15)*eye(3), Segment(6).nV(3,15)*eye(3)];
NV166 = [Segment(6).nV(1,16)*eye(3),(1 + Segment(6).nV(2,16))*eye(3), - Segment(6).nV(2,16)*eye(3), Segment(6).nV(3,16)*eye(3)];
NV176 = [Segment(6).nV(1,17)*eye(3),(1 + Segment(6).nV(2,17))*eye(3), - Segment(6).nV(2,17)*eye(3), Segment(6).nV(3,17)*eye(3)];
NV186 = [Segment(6).nV(1,18)*eye(3),(1 + Segment(6).nV(2,18))*eye(3), - Segment(6).nV(2,18)*eye(3), Segment(6).nV(3,18)*eye(3)];
NV196 = [Segment(6).nV(1,19)*eye(3),(1 + Segment(6).nV(2,19))*eye(3), - Segment(6).nV(2,19)*eye(3), Segment(6).nV(3,19)*eye(3)];
NV206 = [Segment(6).nV(1,20)*eye(3),(1 + Segment(6).nV(2,20))*eye(3), - Segment(6).nV(2,20)*eye(3), Segment(6).nV(3,20)*eye(3)];
NV216 = [Segment(6).nV(1,21)*eye(3),(1 + Segment(6).nV(2,21))*eye(3), - Segment(6).nV(2,21)*eye(3), Segment(6).nV(3,21)*eye(3)];
NV226 = [Segment(6).nV(1,22)*eye(3),(1 + Segment(6).nV(2,22))*eye(3), - Segment(6).nV(2,22)*eye(3), Segment(6).nV(3,22)*eye(3)];
NV236 = [Segment(6).nV(1,23)*eye(3),(1 + Segment(6).nV(2,23))*eye(3), - Segment(6).nV(2,23)*eye(3), Segment(6).nV(3,23)*eye(3)];
NV246 = [Segment(6).nV(1,24)*eye(3),(1 + Segment(6).nV(2,24))*eye(3), - Segment(6).nV(2,24)*eye(3), Segment(6).nV(3,24)*eye(3)];
NV256 = [Segment(6).nV(1,25)*eye(3),(1 + Segment(6).nV(2,25))*eye(3), - Segment(6).nV(2,25)*eye(3), Segment(6).nV(3,25)*eye(3)];
NV266 = [Segment(6).nV(1,26)*eye(3),(1 + Segment(6).nV(2,26))*eye(3), - Segment(6).nV(2,26)*eye(3), Segment(6).nV(3,26)*eye(3)];
NV276 = [Segment(6).nV(1,27)*eye(3),(1 + Segment(6).nV(2,27))*eye(3), - Segment(6).nV(2,27)*eye(3), Segment(6).nV(3,27)*eye(3)];
NV286 = [Segment(6).nV(1,28)*eye(3),(1 + Segment(6).nV(2,28))*eye(3), - Segment(6).nV(2,28)*eye(3), Segment(6).nV(3,28)*eye(3)];
NV296 = [Segment(6).nV(1,29)*eye(3),(1 + Segment(6).nV(2,29))*eye(3), - Segment(6).nV(2,29)*eye(3), Segment(6).nV(3,29)*eye(3)];
NV306 = [Segment(6).nV(1,30)*eye(3),(1 + Segment(6).nV(2,30))*eye(3), - Segment(6).nV(2,30)*eye(3), Segment(6).nV(3,30)*eye(3)];
NV316 = [Segment(6).nV(1,28)*eye(3),(1 + Segment(6).nV(2,28))*eye(3), - Segment(6).nV(2,28)*eye(3), Segment(6).nV(3,28)*eye(3)];
NV326 = [Segment(6).nV(1,32)*eye(3),(1 + Segment(6).nV(2,32))*eye(3), - Segment(6).nV(2,32)*eye(3), Segment(6).nV(3,32)*eye(3)];
NV336 = [Segment(6).nV(1,33)*eye(3),(1 + Segment(6).nV(2,33))*eye(3), - Segment(6).nV(2,33)*eye(3), Segment(6).nV(3,33)*eye(3)];
NV346 = [Segment(6).nV(1,34)*eye(3),(1 + Segment(6).nV(2,34))*eye(3), - Segment(6).nV(2,34)*eye(3), Segment(6).nV(3,34)*eye(3)];
NV356 = [Segment(6).nV(1,35)*eye(3),(1 + Segment(6).nV(2,35))*eye(3), - Segment(6).nV(2,35)*eye(3), Segment(6).nV(3,35)*eye(3)];
NV366 = [Segment(6).nV(1,36)*eye(3),(1 + Segment(6).nV(2,36))*eye(3), - Segment(6).nV(2,36)*eye(3), Segment(6).nV(3,36)*eye(3)];
NV376 = [Segment(6).nV(1,37)*eye(3),(1 + Segment(6).nV(2,37))*eye(3), - Segment(6).nV(2,37)*eye(3), Segment(6).nV(3,37)*eye(3)];
NV386 = [Segment(6).nV(1,38)*eye(3),(1 + Segment(6).nV(2,38))*eye(3), - Segment(6).nV(2,38)*eye(3), Segment(6).nV(3,38)*eye(3)];
NV396 = [Segment(6).nV(1,39)*eye(3),(1 + Segment(6).nV(2,39))*eye(3), - Segment(6).nV(2,39)*eye(3), Segment(6).nV(3,39)*eye(3)];
NV406 = [Segment(6).nV(1,40)*eye(3),(1 + Segment(6).nV(2,40))*eye(3), - Segment(6).nV(2,40)*eye(3), Segment(6).nV(3,40)*eye(3)];
NV416 = [Segment(6).nV(1,41)*eye(3),(1 + Segment(6).nV(2,41))*eye(3), - Segment(6).nV(2,41)*eye(3), Segment(6).nV(3,41)*eye(3)];
NV426 = [Segment(6).nV(1,42)*eye(3),(1 + Segment(6).nV(2,42))*eye(3), - Segment(6).nV(2,42)*eye(3), Segment(6).nV(3,42)*eye(3)];
NV436 = [Segment(6).nV(1,43)*eye(3),(1 + Segment(6).nV(2,43))*eye(3), - Segment(6).nV(2,43)*eye(3), Segment(6).nV(3,43)*eye(3)];
NV446 = [Segment(6).nV(1,44)*eye(3),(1 + Segment(6).nV(2,44))*eye(3), - Segment(6).nV(2,44)*eye(3), Segment(6).nV(3,44)*eye(3)];
NV456 = [Segment(6).nV(1,45)*eye(3),(1 + Segment(6).nV(2,45))*eye(3), - Segment(6).nV(2,45)*eye(3), Segment(6).nV(3,45)*eye(3)];
NV466 = [Segment(6).nV(1,46)*eye(3),(1 + Segment(6).nV(2,46))*eye(3), - Segment(6).nV(2,46)*eye(3), Segment(6).nV(3,46)*eye(3)];
NV476 = [Segment(6).nV(1,47)*eye(3),(1 + Segment(6).nV(2,47))*eye(3), - Segment(6).nV(2,47)*eye(3), Segment(6).nV(3,47)*eye(3)];
NV486 = [Segment(6).nV(1,48)*eye(3),(1 + Segment(6).nV(2,48))*eye(3), - Segment(6).nV(2,48)*eye(3), Segment(6).nV(3,48)*eye(3)];
NV496 = [Segment(6).nV(1,49)*eye(3),(1 + Segment(6).nV(2,49))*eye(3), - Segment(6).nV(2,49)*eye(3), Segment(6).nV(3,49)*eye(3)];
NV506 = [Segment(6).nV(1,50)*eye(3),(1 + Segment(6).nV(2,50))*eye(3), - Segment(6).nV(2,50)*eye(3), Segment(6).nV(3,50)*eye(3)];
NV516 = [Segment(6).nV(1,51)*eye(3),(1 + Segment(6).nV(2,51))*eye(3), - Segment(6).nV(2,51)*eye(3), Segment(6).nV(3,51)*eye(3)];
NV526 = [Segment(6).nV(1,52)*eye(3),(1 + Segment(6).nV(2,52))*eye(3), - Segment(6).nV(2,52)*eye(3), Segment(6).nV(3,52)*eye(3)];
NV536 = [Segment(6).nV(1,53)*eye(3),(1 + Segment(6).nV(2,53))*eye(3), - Segment(6).nV(2,53)*eye(3), Segment(6).nV(3,53)*eye(3)];
NV546 = [Segment(6).nV(1,54)*eye(3),(1 + Segment(6).nV(2,54))*eye(3), - Segment(6).nV(2,54)*eye(3), Segment(6).nV(3,54)*eye(3)];
NV556 = [Segment(6).nV(1,55)*eye(3),(1 + Segment(6).nV(2,55))*eye(3), - Segment(6).nV(2,55)*eye(3), Segment(6).nV(3,55)*eye(3)];
NV566 = [Segment(6).nV(1,56)*eye(3),(1 + Segment(6).nV(2,56))*eye(3), - Segment(6).nV(2,56)*eye(3), Segment(6).nV(3,56)*eye(3)];
NV576 = [Segment(6).nV(1,57)*eye(3),(1 + Segment(6).nV(2,57))*eye(3), - Segment(6).nV(2,57)*eye(3), Segment(6).nV(3,57)*eye(3)];
NV586 = [Segment(6).nV(1,58)*eye(3),(1 + Segment(6).nV(2,58))*eye(3), - Segment(6).nV(2,58)*eye(3), Segment(6).nV(3,58)*eye(3)];
NV596 = [Segment(6).nV(1,59)*eye(3),(1 + Segment(6).nV(2,59))*eye(3), - Segment(6).nV(2,59)*eye(3), Segment(6).nV(3,59)*eye(3)];
NV606 = [Segment(6).nV(1,60)*eye(3),(1 + Segment(6).nV(2,60))*eye(3), - Segment(6).nV(2,60)*eye(3), Segment(6).nV(3,60)*eye(3)];
NV616 = [Segment(6).nV(1,61)*eye(3),(1 + Segment(6).nV(2,61))*eye(3), - Segment(6).nV(2,61)*eye(3), Segment(6).nV(3,61)*eye(3)];
NV626 = [Segment(6).nV(1,62)*eye(3),(1 + Segment(6).nV(2,62))*eye(3), - Segment(6).nV(2,62)*eye(3), Segment(6).nV(3,62)*eye(3)];
NV636 = [Segment(6).nV(1,63)*eye(3),(1 + Segment(6).nV(2,63))*eye(3), - Segment(6).nV(2,63)*eye(3), Segment(6).nV(3,63)*eye(3)];
NV646 = [Segment(6).nV(1,64)*eye(3),(1 + Segment(6).nV(2,64))*eye(3), - Segment(6).nV(2,64)*eye(3), Segment(6).nV(3,64)*eye(3)];
NV656 = [Segment(6).nV(1,65)*eye(3),(1 + Segment(6).nV(2,65))*eye(3), - Segment(6).nV(2,65)*eye(3), Segment(6).nV(3,65)*eye(3)];
NV666 = [Segment(6).nV(1,66)*eye(3),(1 + Segment(6).nV(2,66))*eye(3), - Segment(6).nV(2,66)*eye(3), Segment(6).nV(3,66)*eye(3)];
NV676 = [Segment(6).nV(1,67)*eye(3),(1 + Segment(6).nV(2,67))*eye(3), - Segment(6).nV(2,67)*eye(3), Segment(6).nV(3,67)*eye(3)];
NV686 = [Segment(6).nV(1,68)*eye(3),(1 + Segment(6).nV(2,68))*eye(3), - Segment(6).nV(2,68)*eye(3), Segment(6).nV(3,68)*eye(3)];
NV696 = [Segment(6).nV(1,69)*eye(3),(1 + Segment(6).nV(2,69))*eye(3), - Segment(6).nV(2,69)*eye(3), Segment(6).nV(3,69)*eye(3)];
NV706 = [Segment(6).nV(1,70)*eye(3),(1 + Segment(6).nV(2,70))*eye(3), - Segment(6).nV(2,70)*eye(3), Segment(6).nV(3,70)*eye(3)];
NV716 = [Segment(6).nV(1,71)*eye(3),(1 + Segment(6).nV(2,71))*eye(3), - Segment(6).nV(2,71)*eye(3), Segment(6).nV(3,71)*eye(3)];
NV726 = [Segment(6).nV(1,72)*eye(3),(1 + Segment(6).nV(2,72))*eye(3), - Segment(6).nV(2,72)*eye(3), Segment(6).nV(3,72)*eye(3)];
NV736 = [Segment(6).nV(1,73)*eye(3),(1 + Segment(6).nV(2,73))*eye(3), - Segment(6).nV(2,73)*eye(3), Segment(6).nV(3,73)*eye(3)];
NV746 = [Segment(6).nV(1,74)*eye(3),(1 + Segment(6).nV(2,74))*eye(3), - Segment(6).nV(2,74)*eye(3), Segment(6).nV(3,74)*eye(3)];
NV756 = [Segment(6).nV(1,75)*eye(3),(1 + Segment(6).nV(2,75))*eye(3), - Segment(6).nV(2,75)*eye(3), Segment(6).nV(3,75)*eye(3)];
NV766 = [Segment(6).nV(1,76)*eye(3),(1 + Segment(6).nV(2,76))*eye(3), - Segment(6).nV(2,76)*eye(3), Segment(6).nV(3,76)*eye(3)];
NV776 = [Segment(6).nV(1,77)*eye(3),(1 + Segment(6).nV(2,77))*eye(3), - Segment(6).nV(2,77)*eye(3), Segment(6).nV(3,77)*eye(3)];
NV786 = [Segment(6).nV(1,78)*eye(3),(1 + Segment(6).nV(2,78))*eye(3), - Segment(6).nV(2,78)*eye(3), Segment(6).nV(3,78)*eye(3)];
NV796 = [Segment(6).nV(1,79)*eye(3),(1 + Segment(6).nV(2,79))*eye(3), - Segment(6).nV(2,79)*eye(3), Segment(6).nV(3,79)*eye(3)];
NV806 = [Segment(6).nV(1,80)*eye(3),(1 + Segment(6).nV(2,80))*eye(3), - Segment(6).nV(2,80)*eye(3), Segment(6).nV(3,80)*eye(3)];
NV816 = [Segment(6).nV(1,81)*eye(3),(1 + Segment(6).nV(2,81))*eye(3), - Segment(6).nV(2,81)*eye(3), Segment(6).nV(3,81)*eye(3)];
NV826 = [Segment(6).nV(1,82)*eye(3),(1 + Segment(6).nV(2,82))*eye(3), - Segment(6).nV(2,82)*eye(3), Segment(6).nV(3,82)*eye(3)];


% -------------------------------------------------------------------------
% Generalised lever arms
% -------------------------------------------------------------------------
% Initialisation
Model.Lever = zeros(48,129,n);

% Adductor brevis (prox) 1
Model.Lever(:,1,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV75',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV26,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV75,[1,1,n]),Segment(5).Q)))];
% Adductor brevis (prox) 2
Model.Lever(:,2,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV85',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV36,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV85,[1,1,n]),Segment(5).Q)))];
% Adductor brevis (mid) 1
Model.Lever(:,3,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV95',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV46,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV95,[1,1,n]),Segment(5).Q)))];
% Adductor brevis (mid) 2
Model.Lever(:,4,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV105',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV56,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV105,[1,1,n]),Segment(5).Q)))];
% Adductor brevis (dist) 1
Model.Lever(:,5,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV115',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV66,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV115,[1,1,n]),Segment(5).Q)))];
% Adductor brevis (dist) 2
Model.Lever(:,6,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV125',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV76,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV125,[1,1,n]),Segment(5).Q)))];
% Adductor long 1
Model.Lever(:,7,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV135',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV86,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV135,[1,1,n]),Segment(5).Q)))];
% Adductor long 2
Model.Lever(:,8,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV145',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV96,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV145,[1,1,n]),Segment(5).Q)))];
% Adductor long 3
Model.Lever(:,9,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV155',[1,1,n]),....
    Vnorm_array3(Mprod_array3(repmat(NV106,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV155,[1,1,n]),Segment(5).Q)))];
% Adductor long 4
Model.Lever(:,10,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV165',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV116,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV165,[1,1,n]),Segment(5).Q)))];
% Adductor long 5
Model.Lever(:,11,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV175',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV126,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV175,[1,1,n]),Segment(5).Q)))];
% Adductor long 6
Model.Lever(:,12,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV185',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV136,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV185,[1,1,n]),Segment(5).Q)))];
% Adductor magnus (dist) 1
Model.Lever(:,13,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV195',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV146,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV195,[1,1,n]),Segment(5).Q)))];
% Adductor magnus (dist) 2
Model.Lever(:,14,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV195',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV156,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV195,[1,1,n]),Segment(5).Q)))];
% Adductor magnus (dist) 3
Model.Lever(:,15,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV195',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV166,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV195,[1,1,n]),Segment(5).Q)))];
% Adductor magnus (mid) 1
Model.Lever(:,16,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV205',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV176,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV205,[1,1,n]),Segment(5).Q)))];
% Adductor magnus (mid) 2
Model.Lever(:,17,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV205',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV186,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV205,[1,1,n]),Segment(5).Q)))];
% Adductor magnus (mid) 3
Model.Lever(:,18,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV215',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV196,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV215,[1,1,n]),Segment(5).Q)))];
% Adductor magnus (mid) 4
Model.Lever(:,19,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV215',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV206,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV215,[1,1,n]),Segment(5).Q)))];
% Adductor magnus (mid) 5
Model.Lever(:,20,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV225',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV216,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV225,[1,1,n]),Segment(5).Q)))];
% Adductor magnus (mid) 6
Model.Lever(:,21,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV225',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV226,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV225,[1,1,n]),Segment(5).Q)))];
% Adductor magnus (prox) 1
Model.Lever(:,22,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV235',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV236,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV235,[1,1,n]),Segment(5).Q)))];
% Adductor magnus (prox) 2
Model.Lever(:,23,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV245',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV246,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV245,[1,1,n]),Segment(5).Q)))];
% Adductor magnus (prox) 3
Model.Lever(:,24,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV255',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV256,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV255,[1,1,n]),Segment(5).Q)))];
% Adductor magnus (prox) 4
Model.Lever(:,25,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV265',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV266,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV265,[1,1,n]),Segment(5).Q)))];
% Biceps femoris CL
Model.Lever(:,26,1:n) = [zeros(12,1,n);...
    Mprod_array3(repmat(NV103',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV276,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV103,[1,1,n]),Segment(3).Q)));...
    zeros(12,1,n);...
    zeros(12,1,n)];
% Biceps femoris CB 1
Model.Lever(:,27,1:n) = [zeros(12,1,n);...
    Mprod_array3(repmat(NV103',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV275,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV103,[1,1,n]),Segment(3).Q)));...
    zeros(12,1,n);...
    -Mprod_array3(repmat(NV275',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV275,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV103,[1,1,n]),Segment(3).Q)))];
% Biceps femoris CB 2
Model.Lever(:,30,1:n) = [zeros(12,1,n);...
    Mprod_array3(repmat(NV103',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV285,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV103,[1,1,n]),Segment(3).Q)));...
    zeros(12,1,n);...
    -Mprod_array3(repmat(NV285',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV285,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV103,[1,1,n]),Segment(3).Q)))];
% Biceps femoris CB 3
Model.Lever(:,29,1:n) = [zeros(12,1,n);...
    Mprod_array3(repmat(NV103',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV295,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV103,[1,1,n]),Segment(3).Q)));...
    zeros(12,1,n);...
    -Mprod_array3(repmat(NV295',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV295,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV103,[1,1,n]),Segment(3).Q)))];
% Ext. Dig. Long 1&2&3
Model.Lever(:,30,1:n) = [Mprod_array3(repmat(NV42',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV113,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV42,[1,1,n]),Segment(2).Q)));...
    -Mprod_array3(repmat(NV113',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV113,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV42,[1,1,n]),Segment(2).Q)));...
    zeros(12,1,n);...
    zeros(12,1,n)];
% Ext. Hal. Long  1&2&3
Model.Lever(:,31,1:n) = [Mprod_array3(repmat(NV52',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV123,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV52,[1,1,n]),Segment(2).Q)));...
    -Mprod_array3(repmat(NV123',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV123,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV52,[1,1,n]),Segment(2).Q)));...
    zeros(12,1,n);...
    zeros(12,1,n)];
% Flex. Dig. Long  1&2&3
Model.Lever(:,32,1:n) = [Mprod_array3(repmat(NV62',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV133,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV62,[1,1,n]),Segment(2).Q)));...
    -Mprod_array3(repmat(NV133',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV133,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV62,[1,1,n]),Segment(2).Q)));
    zeros(12,1,n);...
    zeros(12,1,n)];
% Flex. Hal. Long  1&2&3
Model.Lever(:,33,1:n) = [Mprod_array3(repmat(NV72',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV143,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV72,[1,1,n]),Segment(2).Q)));...
    -Mprod_array3(repmat(NV143',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV143,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV72,[1,1,n]),Segment(2).Q)));
    zeros(12,1,n);...
    zeros(12,1,n)];
% Gastrocnemius (lat)
Model.Lever(:,34,1:n) = [Mprod_array3(repmat(NV82',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV305,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV82,[1,1,n]),Segment(2).Q)));...
    zeros(12,1,n);...
    zeros(12,1,n);...
    -Mprod_array3(repmat(NV305',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV305,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV82,[1,1,n]),Segment(2).Q)))];
% Gastrocnemius (med)
Model.Lever(:,35,1:n) = [Mprod_array3(repmat(NV92',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV315,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV92,[1,1,n]),Segment(2).Q)));...
    zeros(12,1,n);...
    zeros(12,1,n);...
    -Mprod_array3(repmat(NV315',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV315,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV92,[1,1,n]),Segment(2).Q)))];
% Gemellus (inf)
Model.Lever(:,36,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV325',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV286,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV325,[1,1,n]),Segment(5).Q)))];
% Gemellus (sup)
Model.Lever(:,37,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV335',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV296,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV335,[1,1,n]),Segment(5).Q)))];
% Gluteus maximus (sup) 1
Model.Lever(:,38,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV345',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV306,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV345,[1,1,n]),Segment(5).Q)))];
% Gluteus maximus (sup) 2
Model.Lever(:,39,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV355',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV316,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV355,[1,1,n]),Segment(5).Q)))];
% Gluteus maximus (sup) 3
Model.Lever(:,40,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV365',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV326,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV365,[1,1,n]),Segment(5).Q)))];
% Gluteus maximus (sup) 4
Model.Lever(:,41,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV375',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV336,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV375,[1,1,n]),Segment(5).Q)))];
% Gluteus maximus (sup) 5
Model.Lever(:,42,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV385',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV346,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV385,[1,1,n]),Segment(5).Q)))];
% Gluteus maximus (sup) 6
Model.Lever(:,43,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV395',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV356,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV395,[1,1,n]),Segment(5).Q)))];
% Gluteus maximus (inf) 1
Model.Lever(:,44,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV405',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV366,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV405,[1,1,n]),Segment(5).Q)))];
% Gluteus maximus (inf) 2
Model.Lever(:,45,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV415',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV376,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV415,[1,1,n]),Segment(5).Q)))];
% Gluteus maximus (inf) 3
Model.Lever(:,46,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV425',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV386,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV425,[1,1,n]),Segment(5).Q)))];
% Gluteus maximus (inf) 4
Model.Lever(:,47,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV435',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV396,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV435,[1,1,n]),Segment(5).Q)))];
% Gluteus maximus (inf) 5
Model.Lever(:,48,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV445',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV406,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV445,[1,1,n]),Segment(5).Q)))];
% Gluteus maximus (inf) 6
Model.Lever(:,49,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV455',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV416,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV455,[1,1,n]),Segment(5).Q)))];
% Gluteus medius (ant) 1
Model.Lever(:,50,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV465',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV426,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV465,[1,1,n]),Segment(5).Q)))];
% Gluteus medius (ant) 2
Model.Lever(:,51,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV475',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV436,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV475,[1,1,n]),Segment(5).Q)))];
% Gluteus medius (ant) 3
Model.Lever(:,52,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV485',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV446,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV485,[1,1,n]),Segment(5).Q)))];
% Gluteus medius (ant) 4
Model.Lever(:,53,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV495',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV456,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV495,[1,1,n]),Segment(5).Q)))];
% Gluteus medius (ant) 5
Model.Lever(:,54,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV505',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV466,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV505,[1,1,n]),Segment(5).Q)))];
% Gluteus medius (ant) 6
Model.Lever(:,55,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV515',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV476,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV515,[1,1,n]),Segment(5).Q)))];
% Gluteus medius (post) 1
Model.Lever(:,56,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV525',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV486,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV525,[1,1,n]),Segment(5).Q)))];
% Gluteus medius (post) 2
Model.Lever(:,57,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV535',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV496,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV535,[1,1,n]),Segment(5).Q)))];
% Gluteus medius (post) 3
Model.Lever(:,58,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV545',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV506,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV545,[1,1,n]),Segment(5).Q)))];
% Gluteus medius (post) 4
Model.Lever(:,59,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV555',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV516,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV555,[1,1,n]),Segment(5).Q)))];
% Gluteus medius (post) 5
Model.Lever(:,60,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV565',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV526,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV565,[1,1,n]),Segment(5).Q)))];
% Gluteus medius (post) 6
Model.Lever(:,61,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV575',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV536,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV575,[1,1,n]),Segment(5).Q)))];
% Gluteus minimus (ant)
Model.Lever(:,62,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV585',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV546,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV585,[1,1,n]),Segment(5).Q)))];
% Gluteus minimus (mid)
Model.Lever(:,63,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV585',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV556,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV585,[1,1,n]),Segment(5).Q)))];
% Gluteus minimus (mid)
Model.Lever(:,64,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV585',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV566,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV585,[1,1,n]),Segment(5).Q)))];
% Gracilis 1
Model.Lever(:,65,1:n) = [zeros(12,1,n);...
    Mprod_array3(repmat(NV153',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV576,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV153,[1,1,n]),Segment(3).Q)));...
    zeros(12,1,n);...
    zeros(12,1,n)];
% Gracilis 2
Model.Lever(:,66,1:n) = [zeros(12,1,n);...
    Mprod_array3(repmat(NV153',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV586,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV153,[1,1,n]),Segment(3).Q)));...
    zeros(12,1,n);...
    zeros(12,1,n)];
% Illiacus
Model.Lever(:,67,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV595',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV596,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV595,[1,1,n]),Segment(5).Q)))];
% Obturateur ext (inf) 1
Model.Lever(:,68,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV605',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV606,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV605,[1,1,n]),Segment(5).Q)))];
% Obturateur ext (inf) 2
Model.Lever(:,69,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV605',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV616,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV605,[1,1,n]),Segment(5).Q)))];
% Obturateur ext (sup) 1
Model.Lever(:,70,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV615',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV626,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV615,[1,1,n]),Segment(5).Q)))];
% Obturateur ext (sup) 2
Model.Lever(:,71,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV615',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV636,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV615,[1,1,n]),Segment(5).Q)))];
% Obturateur ext (sup) 3
Model.Lever(:,72,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV615',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV646,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV615,[1,1,n]),Segment(5).Q)))];
% Obturateur int
Model.Lever(:,73,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV625',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV656,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV625,[1,1,n]),Segment(5).Q)))];
% Pectinus 1
Model.Lever(:,74,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV635',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV666,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV635,[1,1,n]),Segment(5).Q)))];
% Pectinus 2
Model.Lever(:,75,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV645',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV676,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV645,[1,1,n]),Segment(5).Q)))];
% Pectinus 3
Model.Lever(:,76,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV655',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV686,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV655,[1,1,n]),Segment(5).Q)))];
% Pectinus 4
Model.Lever(:,77,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV665',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV696,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV665,[1,1,n]),Segment(5).Q)))];
% Peroneus brevis
Model.Lever(:,78,1:n) = [Mprod_array3(repmat(NV102',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV163,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV102,[1,1,n]),Segment(2).Q)));...
    -Mprod_array3(repmat(NV163',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV163,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV102,[1,1,n]),Segment(2).Q)));
    zeros(12,1,n);...
    zeros(12,1,n)];
% Peroneus longus
Model.Lever(:,79,1:n) = [Mprod_array3(repmat(NV112',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV163,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV112,[1,1,n]),Segment(2).Q)));...
    -Mprod_array3(repmat(NV163',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV163,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV112,[1,1,n]),Segment(2).Q)));
    zeros(12,1,n);...
    zeros(12,1,n)];
% Peroneus tert
Model.Lever(:,80,1:n) = [Mprod_array3(repmat(NV122',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV173,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV122,[1,1,n]),Segment(2).Q)));...
    -Mprod_array3(repmat(NV173',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV173,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV122,[1,1,n]),Segment(2).Q)));
    zeros(12,1,n);...
    zeros(12,1,n)];
% Piriformis
Model.Lever(:,81,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV675',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV706,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV675,[1,1,n]),Segment(5).Q)))];
% Plantaris
Model.Lever(:,82,1:n) = [Mprod_array3(repmat(NV132',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV685,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV132,[1,1,n]),Segment(2).Q)));...
    zeros(12,1,n);...
    zeros(12,1,n);...
    -Mprod_array3(repmat(NV685',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV685,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV132,[1,1,n]),Segment(2).Q)))];
% Popliteus 1&2
Model.Lever(:,83,1:n) = [ zeros(12,1,n) ;...
    Mprod_array3(repmat(NV183',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV695,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV183,[1,1,n]),Segment(3).Q)));...
    zeros(12,1,n);...
    -Mprod_array3(repmat(NV695',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV695,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV183,[1,1,n]),Segment(3).Q)))];
% Psoas minor
Model.Lever(:,84,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV705',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV716,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV705,[1,1,n]),Segment(5).Q)))];
% Psoas major
Model.Lever(:,85,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV715',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV726,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV715,[1,1,n]),Segment(5).Q)))];
% Quadratis femoris 1
Model.Lever(:,86,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV725',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV736,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV725,[1,1,n]),Segment(5).Q)))];
% Quadratis femoris 2
Model.Lever(:,87,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV735',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV746,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV735,[1,1,n]),Segment(5).Q)))];
% Quadratis femoris 3
Model.Lever(:,88,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV745',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV756,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV745,[1,1,n]),Segment(5).Q)))];
% Quadratis femoris 4
Model.Lever(:,89,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV755',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV766,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV755,[1,1,n]),Segment(5).Q)))];
% Rectus femoris 1
Model.Lever(:,90,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV24',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV776,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)));...
    zeros(12,1,n)];
% Rectus femoris 2
Model.Lever(:,91,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV34',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV776,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV34,[1,1,n]),Segment(4).Q)));...
    zeros(12,1,n)];
% Sartorius (prox)
Model.Lever(:,92,1:n) = [zeros(12,1,n);...
    Mprod_array3(repmat(NV193',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV775,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV193,[1,1,n]),Segment(3).Q)));...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV765',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV786,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV765,[1,1,n]),Segment(5).Q)))-...
    Mprod_array3(repmat(NV775',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV775,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV193,[1,1,n]),Segment(3).Q)))];
% Sartorius (dist)
Model.Lever(:,93,1:n) = [zeros(12,1,n);...
    Mprod_array3(repmat(NV193',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV785,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV193,[1,1,n]),Segment(3).Q)));...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV785',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV786,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV785,[1,1,n]),Segment(5).Q)))-...
    Mprod_array3(repmat(NV785',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV785,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV193,[1,1,n]),Segment(3).Q)))];
% Semimembronosus
Model.Lever(:,94,1:n) = [zeros(12,1,n);...
    Mprod_array3(repmat(NV203',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV796,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV203,[1,1,n]),Segment(3).Q)));...
    zeros(12,1,n);...
    zeros(12,1,n)];
% Semitendinus
Model.Lever(:,95,1:n) = [zeros(12,1,n);...
    Mprod_array3(repmat(NV213',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV806,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV213,[1,1,n]),Segment(3).Q)));...
    zeros(12,1,n);...
    zeros(12,1,n)];
% Soleus (med)  1
Model.Lever(:,96,1:n) = [Mprod_array3(repmat(NV142',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV223,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV142,[1,1,n]),Segment(2).Q)));...
    -Mprod_array3(repmat(NV223',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV223,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV142,[1,1,n]),Segment(2).Q)));
    zeros(12,1,n);...
    zeros(12,1,n)];
% Soleus (med)  2
Model.Lever(:,97,1:n) = [Mprod_array3(repmat(NV142',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV233,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV142,[1,1,n]),Segment(2).Q)));...
    -Mprod_array3(repmat(NV233',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV233,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV142,[1,1,n]),Segment(2).Q)));
    zeros(12,1,n);...
    zeros(12,1,n)];
% Soleus (med)  3
Model.Lever(:,98,1:n) = [Mprod_array3(repmat(NV142',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV243,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV142,[1,1,n]),Segment(2).Q)));...
    -Mprod_array3(repmat(NV243',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV243,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV142,[1,1,n]),Segment(2).Q)));
    zeros(12,1,n);...
    zeros(12,1,n)];
% Soleus (lat)  1
Model.Lever(:,99,1:n) = [Mprod_array3(repmat(NV152',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV253,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV152,[1,1,n]),Segment(2).Q)));...
    -Mprod_array3(repmat(NV253',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV253,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV152,[1,1,n]),Segment(2).Q)));
    zeros(12,1,n);...
    zeros(12,1,n)];
% Soleus (lat)  2
Model.Lever(:,100,1:n) = [Mprod_array3(repmat(NV152',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV263,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV152,[1,1,n]),Segment(2).Q)));...
    -Mprod_array3(repmat(NV263',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV263,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV152,[1,1,n]),Segment(2).Q)));
    zeros(12,1,n);...
    zeros(12,1,n)];
% Soleus (lat)  3
Model.Lever(:,101,1:n) = [Mprod_array3(repmat(NV152',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV273,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV152,[1,1,n]),Segment(2).Q)));...
    -Mprod_array3(repmat(NV273',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV273,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV152,[1,1,n]),Segment(2).Q)));
    zeros(12,1,n);...
    zeros(12,1,n)];
% Tensor fascia late 1
Model.Lever(:,102,1:n) = [zeros(12,1,n);...
    Mprod_array3(repmat(NV283',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV816,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV283,[1,1,n]),Segment(3).Q)));...
    zeros(12,1,n);...
    zeros(12,1,n)];
% Tensor fascia late 2
Model.Lever(:,103,1:n) = [zeros(12,1,n);...
    Mprod_array3(repmat(NV283',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV826,[1,1,n]),Segment(6).Q) - Mprod_array3(repmat(NV283,[1,1,n]),Segment(3).Q)));...
    zeros(12,1,n);...
    zeros(12,1,n)];
% Tibialis anterior
Model.Lever(:,104,1:n) = [Mprod_array3(repmat(NV162',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV293,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV162,[1,1,n]),Segment(2).Q)));...
    -Mprod_array3(repmat(NV293',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV293,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV162,[1,1,n]),Segment(2).Q)));
    zeros(12,1,n);...
    zeros(12,1,n)];
% Tibialis posterior (med&lat)
Model.Lever(:,105,1:n) = [Mprod_array3(repmat(NV172',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV303,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV172,[1,1,n]),Segment(2).Q)));...
    -Mprod_array3(repmat(NV303',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV303,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV172,[1,1,n]),Segment(2).Q)));
    zeros(12,1,n);...
    zeros(12,1,n)];
% Vastus interm.  1
Model.Lever(:,106,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV24',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV795,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)));...
    -Mprod_array3(repmat(NV795',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV795,[1,1,n]),Segment(3).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)))];
% Vastus interm.  2
Model.Lever(:,107,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV24',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV805,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)));...
    -Mprod_array3(repmat(NV805',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV805,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)))];
% Vastus interm.  3
Model.Lever(:,108,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV24',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV815,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)));...
    -Mprod_array3(repmat(NV815',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV815,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)))];
% Vastus interm.  4
Model.Lever(:,109,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV34',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV825,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV34,[1,1,n]),Segment(4).Q)));...
    -Mprod_array3(repmat(NV825',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV825,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV34,[1,1,n]),Segment(4).Q)))];
% Vastus interm.  5
Model.Lever(:,110,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV34',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV835,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV34,[1,1,n]),Segment(4).Q)));...
    -Mprod_array3(repmat(NV835',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV835,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV34,[1,1,n]),Segment(4).Q)))];
% Vastus interm.  6
Model.Lever(:,111,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV34',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV845,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV34,[1,1,n]),Segment(4).Q)));...
    -Mprod_array3(repmat(NV845',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV845,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV34,[1,1,n]),Segment(4).Q)))];
% Vastus lat. (inf) 1
Model.Lever(:,112,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV34',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV855,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV34,[1,1,n]),Segment(4).Q)));...
    -Mprod_array3(repmat(NV855',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV855,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV34,[1,1,n]),Segment(4).Q)))];
% Vastus lat. (inf) 2
Model.Lever(:,113,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV34',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV865,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV34,[1,1,n]),Segment(4).Q)));...
    -Mprod_array3(repmat(NV865',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV865,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV34,[1,1,n]),Segment(4).Q)))];
% Vastus lat. (inf) 3
Model.Lever(:,114,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV34',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV875,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV34,[1,1,n]),Segment(4).Q)));...
    -Mprod_array3(repmat(NV875',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV875,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV34,[1,1,n]),Segment(4).Q)))];
% Vastus lat. (inf) 4
Model.Lever(:,115,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV34',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV885,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV34,[1,1,n]),Segment(4).Q)));...
    -Mprod_array3(repmat(NV885',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV885,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV34,[1,1,n]),Segment(4).Q)))];
% Vastus lat. (inf) 5
Model.Lever(:,116,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV34',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV895,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV34,[1,1,n]),Segment(4).Q)));...
    -Mprod_array3(repmat(NV895',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV895,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV34,[1,1,n]),Segment(4).Q)))];
% Vastus lat. (inf) 1
Model.Lever(:,117,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV34',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV905,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV34,[1,1,n]),Segment(4).Q)));...
    -Mprod_array3(repmat(NV905',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV905,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV34,[1,1,n]),Segment(4).Q)))];
% Vastus lat. (sup) 1
Model.Lever(:,118,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV34',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV915,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV34,[1,1,n]),Segment(4).Q)));...
    -Mprod_array3(repmat(NV915',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV915,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV34,[1,1,n]),Segment(4).Q)))];
% Vastus lat. (sup) 2
Model.Lever(:,119,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV34',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV925,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV34,[1,1,n]),Segment(4).Q)));...
    -Mprod_array3(repmat(NV925',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV925,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV34,[1,1,n]),Segment(4).Q)))];
% Vastus med. (inf) 1
Model.Lever(:,120,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV24',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV935,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)));...
    -Mprod_array3(repmat(NV935',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV935,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)))];
% Vastus med. (inf) 2
Model.Lever(:,121,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV24',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV945,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)));...
    -Mprod_array3(repmat(NV945',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV945,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)))];
% Vastus med. (mid) 1
Model.Lever(:,122,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV24',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV955,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)));...
    -Mprod_array3(repmat(NV955',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV955,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)))];
% Vastus med. (mid) 2
Model.Lever(:,123,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV24',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV965,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)));...
    -Mprod_array3(repmat(NV965',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV965,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)))];
% Vastus med. (sup) 1
Model.Lever(:,124,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV24',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV975,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)));...
    -Mprod_array3(repmat(NV975',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV975,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)))];
% Vastus med. (sup) 2
Model.Lever(:,125,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV24',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV985,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)));...
    -Mprod_array3(repmat(NV985',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV985,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)))];
% Vastus med. (sup) 3
Model.Lever(:,126,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV24',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV995,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)));...
    -Mprod_array3(repmat(NV995',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV995,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)))];
% Vastus med. (sup) 4
Model.Lever(:,127,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV24',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV1005,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)));...
    -Mprod_array3(repmat(NV1005',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV1005,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)))];
% Vastus med. (sup) 5
Model.Lever(:,128,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV24',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV1015,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)));...
    -Mprod_array3(repmat(NV1015',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV1015,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)))];
% Vastus med. (sup) 6
Model.Lever(:,129,1:n) = [zeros(12,1,n);...
    zeros(12,1,n);...
    Mprod_array3(repmat(NV24',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV1025,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)));...
    -Mprod_array3(repmat(NV1025',[1,1,n]),...
    Vnorm_array3(Mprod_array3(repmat(NV1025,[1,1,n]),Segment(5).Q) - Mprod_array3(repmat(NV24,[1,1,n]),Segment(4).Q)))];


% -------------------------------------------------------------------
% Force max (Modenese et al. 2013)
% -------------------------------------------------------------------------
Model.Fmax(1,1) = 395.9/6; % Adductor brevis (prox) 1
Model.Fmax(2,1) = 395.9/6 ; % Adductor brevis (prox) 2
Model.Fmax(3,1) = 395.9/6 ; % Adductor brevis (mid) 1
Model.Fmax(4,1) = 395.9/6; % Adductor brevis (mid) 2
Model.Fmax(5,1) = 395.9/6; % Adductor brevis (dist) 1
Model.Fmax(6,1) = 395.9/6; % Adductor brevis (dist) 2
Model.Fmax(7,1) = 569.3/6; % Adductor long 1
Model.Fmax(8,1) = 569.3/6; % Adductor long 2
Model.Fmax(9,1) = 569.3/6; % Adductor long 3
Model.Fmax(10,1) = 569.3/6; % Adductor long 4
Model.Fmax(11,1) = 569.3/6; % Adductor long 5
Model.Fmax(12,1) = 569.3/6; % Adductor long 6
Model.Fmax(13,1) = 2020.7/13; % Adductor magnus (dist) 1
Model.Fmax(14,1) = 2020.7/13; % Adductor magnus (dist) 2
Model.Fmax(15,1) = 2020.7/13; % Adductor magnus (dist) 3
Model.Fmax(16,1) = 2020.7/13; % Adductor magnus (mid) 1
Model.Fmax(17,1) = 2020.7/13; % Adductor magnus (mid) 2
Model.Fmax(18,1) = 2020.7/13; % Adductor magnus (mid) 3
Model.Fmax(19,1) = 2020.7/13; % Adductor magnus (mid) 4
Model.Fmax(20,1) = 2020.7/13; % Adductor magnus (mid) 5
Model.Fmax(21,1) = 2020.7/13; % Adductor magnus (mid) 6
Model.Fmax(22,1) = 2020.7/13; % Adductor magnus (prox) 1
Model.Fmax(23,1) = 2020.7/13; % Adductor magnus (prox) 2
Model.Fmax(24,1) = 2020.7/13; % Adductor magnus (prox) 3
Model.Fmax(25,1) = 2020.7/13; % Adductor magnus (prox) 4
Model.Fmax(26,1) = 1025.4; % Biceps femoris CL
Model.Fmax(27,1) = 444.9/3; % Biceps femoris CB 1
Model.Fmax(28,1) = 444.9/3; % Biceps femoris CB 2
Model.Fmax(29,1) = 444.9/3; % Biceps femoris CB 3
Model.Fmax(30,1) = 203.6; % Ext. Dig. Long 1&2&3
Model.Fmax(31,1) = 230; % Ext. Hal. Long  1&2&3
Model.Fmax(32,1) = 248.8; % Flex. Dig. Long  1&2&3
Model.Fmax(33,1) = 1172.5; % Flex. Hal. Long  1&2&3
Model.Fmax(34,1) = 904.8; % Gastrocnemius (lat)
Model.Fmax(35,1) = 1651.3; % Gastrocnemius (med
Model.Fmax(36,1) = 309.1/2; % Gemellus (inf)
Model.Fmax(37,1) = 309.1/2; % Gemellus  (sup)
Model.Fmax(38,1) = 1852.6/12; % Gluteus maximus (sup) 1
Model.Fmax(39,1) = 2721.9/12; % Gluteus maximus (sup) 2
Model.Fmax(40,1) = 2721.9/12; % Gluteus maximus (sup) 3
Model.Fmax(41,1) = 2721.9/12; % Gluteus maximus (sup) 4
Model.Fmax(42,1) = 2721.9/12; % Gluteus maximus (sup) 5
Model.Fmax(43,1) = 2721.9/12; % Gluteus maximus (sup) 6
Model.Fmax(44,1) = 2721.9/12; % Gluteus Maximus (inf) 1
Model.Fmax(45,1) = 2721.9/12; % Gluteus Maximus (inf) 2
Model.Fmax(46,1) = 2721.9/12; % Gluteus Maximus (inf) 3
Model.Fmax(47,1) = 2721.9/12; % Gluteus Maximus (inf) 4
Model.Fmax(48,1) = 2721.9/12; % Gluteus Maximus (inf) 5
Model.Fmax(49,1) = 2721.9/12; % Gluteus Maximus (inf) 6
Model.Fmax(50,1) = 3721.0/12; % Gluteus medius (ant) 1
Model.Fmax(51,1) = 3721.0/12; % Gluteus medius (ant) 2
Model.Fmax(52,1) = 3721.0/12; % Gluteus medius (ant) 3
Model.Fmax(53,1) = 3721.0/12; % Gluteus medius (ant) 4
Model.Fmax(54,1) = 3721.0/12; % Gluteus medius (ant) 5
Model.Fmax(55,1) = 3721.0/12; % Gluteus medius (ant) 6
Model.Fmax(56,1) = 3721.0/12; % Gluteus medius (post) 1
Model.Fmax(57,1) = 3721.0/12; % Gluteus medius (post) 2
Model.Fmax(58,1) = 3721.0/12; % Gluteus medius (post) 3
Model.Fmax(59,1) = 3721.0/12; % Gluteus medius (post) 4
Model.Fmax(60,1) = 3721.0/12; % Gluteus medius (post) 5
Model.Fmax(61,1) = 3721.0/12; % Gluteus medius (post) 6
Model.Fmax(62,1) = 961.4/3; % Gluteus minimus (ant)
Model.Fmax(63,1) = 961.4/3; % Gluteus minimus (mid)
Model.Fmax(64,1) = 961.4/3; % Gluteus minimus (post)
Model.Fmax(65,1) = 184.7/2; % Gracilis 1
Model.Fmax(66,1) = 184.7/2; % Gracilis 2
Model.Fmax(67,1) = 1025.4; % Illiacus
Model.Fmax(68,1) = 1134.8/5; % Obturator ext (inf) 1
Model.Fmax(69,1) = 1134.8/5; % Obturator ext (inf) 2
Model.Fmax(70,1) = 1134.8/5; % Obturator ext (sup) 1
Model.Fmax(71,1) = 1134.8/5; % Obturator ext (sup) 2
Model.Fmax(72,1) = 1134.8/5; % Obturator ext (sup) 3
Model.Fmax(73,1) = 957.6; % Obturator int
Model.Fmax(74,1) = 256.4/4; % Pectinus 1
Model.Fmax(75,1) = 256.4/4; % Pectinus 2
Model.Fmax(76,1) = 256.4/4; % Pectinus 3
Model.Fmax(77,1) = 256.4/4; % Pectinus 4
Model.Fmax(78,1) = 716.3; % Peroneus brevis
Model.Fmax(79,1) = 901; % Peroneus  longus
Model.Fmax(80,1) = 233.7; % Peroneus tert
Model.Fmax(81,1) = 305.4; % Piriformis
Model.Fmax(82,1) = 90.5; % Plantaris
Model.Fmax(83,1) = 403.4; % Popliteus
Model.Fmax(84,1) = 776.6/2; % Psoas minor
Model.Fmax(85,1) = 776.6/2; % Psoas major
Model.Fmax(86,1) = 550.4/4; % Quadratis femoris 1
Model.Fmax(87,1) = 550.4/4; % Quadratis femoris 2
Model.Fmax(88,1) = 550.4/4; % Quadratis femoris 3
Model.Fmax(89,1) = 550.4/4; % Quadratis femoris 4
Model.Fmax(90,1) = 1089.5/2; % Rectus femoris 1
Model.Fmax(91,1) = 1089.5/2; % Rectus femoris 2
Model.Fmax(92,1) = 44.9/2;  %Sartorius (prox)
Model.Fmax(93,1) = 44.9/2; % Sartorius (dist)
Model.Fmax(94,1) = 644.7; % Semimembranosus
Model.Fmax(95,1) = 554.2; % Semitendinus
Model.Fmax(96,1) = 6793.5/6; % Soleus (med) 1
Model.Fmax(97,1) = 6793.5/6; % Soleus (med) 2
Model.Fmax(98,1) = 6793.5/6; % Soleus (med) 3
Model.Fmax(99,1) = 6793.5/6; % Soleus (lat) 1
Model.Fmax(100,1) = 6793.5/6; % Soleus (lat) 2
Model.Fmax(101,1) =	6793.5/6; % Soleus (lat) 3
Model.Fmax(102,1) =	331.8/2; % Tensor fascia late 1
Model.Fmax(103,1) = 331.8/2; % Tensor fascia late 2
Model.Fmax(104,1) = 1002.8; % Tibialis anterior
Model.Fmax(105,1) =	1628.6; % Tibial post. (med&lat)
Model.Fmax(106,1) =	1436.4/6; % Vastus interm. 1
Model.Fmax(107,1) =	1436.4/6; % Vastus interm. 2
Model.Fmax(108,1) = 1436.4/6; % Vastus interm. 3
Model.Fmax(109,1) = 1436.4/6; % Vastus interm. 4
Model.Fmax(110,1) = 1436.4/6; % Vastus interm. 5
Model.Fmax(111,1) = 1436.4/6; % Vastus interm. 6
Model.Fmax(112,1) = 2627.7/8; % Vastus lat. (inf) 1
Model.Fmax(113,1) = 2627.7/8; % Vastus lat. (inf) 2
Model.Fmax(114,1) = 2627.7/8; % Vastus lat. (inf) 3
Model.Fmax(115,1) = 2627.7/8; % Vastus lat. (inf) 4
Model.Fmax(116,1) = 2627.7/8; % Vastus lat. (inf) 5
Model.Fmax(117,1) = 2627.7/8; % Vastus lat. (inf) 6
Model.Fmax(118,1) = 2627.7/8; % Vastus lat. (sup) 1
Model.Fmax(119,1) =	2627.7/8; % Vastus lat. (sup) 2
Model.Fmax(120,1) = 2258.2/10; % Vastus med (inf) 1
Model.Fmax(121,1) =	2258.2/10; % Vastus med (inf) 2
Model.Fmax(122,1) =	2258.2/10; % Vastus med (mid) 1
Model.Fmax(123,1) = 2258.2/10; % Vastus med (mid) 2
Model.Fmax(124,1) = 2258.2/10; % Vastus med. (sup) 1
Model.Fmax(125,1) = 2258.2/10; % Vastus med. (sup) 2
Model.Fmax(126,1) = 2258.2/10; % Vastus med. (sup) 3
Model.Fmax(127,1) = 2258.2/10; % Vastus med. (sup) 4
Model.Fmax(128,1) = 2258.2/10; % Vastus med. (sup) 5
Model.Fmax(129,1) = 2258.2/10; % Vastus med. (sup) 6

% -------------------------------------------------------------------------
% PCSA (Klein Horsman et al. 2007)
% -------------------------------------------------------------------------
Model.PCSA(1,1) = 3.8/2         ;%Adductor brevis (prox) 1
Model.PCSA(2,1) = 3.8/2         ;%Adductor brevis (prox) 2
Model.PCSA(3,1) = 3.5/2         ;%Adductor brevis (mid) 1
Model.PCSA(4,1) = 3.5/2         ;%Adductor brevis (mid) 2
Model.PCSA(5,1) = 3.2/2         ;%Adductor brevis (dist) 1
Model.PCSA(6,1) = 3.2/2         ;%Adductor brevis (dist) 2
Model.PCSA(7,1) = 15.1/6        ;%Adductor long 1
Model.PCSA(8,1) = 15.1/6        ;%Adductor long 2
Model.PCSA(9,1) = 15.1/6        ;%Adductor long 3
Model.PCSA(10,1) = 15.1/6       ;%Adductor long 4
Model.PCSA(11,1) = 15.1/6       ;%Adductor long 5
Model.PCSA(12,1) = 15.1/6       ;%Adductor long 6
Model.PCSA(13,1) = 26.5/3       ;%Adductor magnus (dist) 1
Model.PCSA(14,1) = 26.5/3       ;%Adductor magnus (dist) 2
Model.PCSA(15,1) = 26.5/3       ;%Adductor magnus (dist) 3
Model.PCSA(16,1) = 22.1/6       ;%Adductor magnus (mid) 1
Model.PCSA(17,1) = 22.1/6       ;%Adductor magnus (mid) 2
Model.PCSA(18,1) = 22.1/6       ;%Adductor magnus (mid) 3
Model.PCSA(19,1) = 22.1/6       ;%Adductor magnus (mid) 4
Model.PCSA(20,1) = 22.1/6       ;%Adductor magnus (mid) 5
Model.PCSA(21,1) = 22.1/6       ;%Adductor magnus (mid) 6
Model.PCSA(22,1) = 5/4          ;%Adductor magnus (prox) 1
Model.PCSA(23,1) = 5/4          ;%Adductor magnus (prox) 2
Model.PCSA(24,1) = 5/4          ;%Adductor magnus (prox) 3
Model.PCSA(25,1) = 5/4          ;%Adductor magnus (prox) 4
Model.PCSA(26,1) = 27.2         ;%Biceps femoris CL
Model.PCSA(27,1) = 11.8/3       ;%Biceps Femoris CB 1
Model.PCSA(28,1) = 11.8/3       ;%Biceps Femoris CB  2
Model.PCSA(29,1) = 11.8/3       ;%Biceps Femoris CB  3
Model.PCSA(30,1) = 5.4          ;%Ext. Dig. Long 1&2&3
Model.PCSA(31,1) = 6.1          ;%Ext. Hal. Long  1&2&3
Model.PCSA(32,1) = 6.6          ;%Flex. Dig. Long  1&2&3
Model.PCSA(33,1) = 31.1         ;%Flex. Hal. Long  1&2&3
Model.PCSA(34,1) = 24.0         ;%Gastrocnemius (lat)
Model.PCSA(35,1) = 43.8         ;%Gastrocnemius (med
Model.PCSA(36,1) = 4.1          ;%Gemellus (inf)
Model.PCSA(37,1) = 4.1          ;%Gemellus  (sup)
Model.PCSA(38,1) = 49.7/6       ;%Gluteus maximus (sup)       1
Model.PCSA(39,1) = 49.7/6       ;%Gluteus maximus (sup)       2
Model.PCSA(40,1) = 49.7/6       ;%Gluteus maximus (sup)       3
Model.PCSA(41,1) = 49.7/6       ;%Gluteus maximus (sup)       4
Model.PCSA(42,1) = 49.7/6       ;%Gluteus maximus (sup)       5
Model.PCSA(43,1) = 49.7/6       ;%Gluteus maximus (sup)       6
Model.PCSA(44,1) = 22.5/6       ;%Gluteus Maximus (inf)     1
Model.PCSA(45,1) = 22.5/6       ;%Gluteus Maximus (inf)     2
Model.PCSA(46,1) = 22.5/6       ;%Gluteus Maximus (inf)     3
Model.PCSA(47,1) = 22.5/6       ;%Gluteus Maximus (inf)     4
Model.PCSA(48,1) = 22.5/6       ;%Gluteus Maximus (inf)     5
Model.PCSA(49,1) = 22.5/6       ;%Gluteus Maximus (inf)     6
Model.PCSA(50,1) = 37.9/6       ;%Gluteus medius  (ant)      1
Model.PCSA(51,1) = 37.9/6       ;%Gluteus medius  (ant)      2
Model.PCSA(52,1) = 37.9/6       ;%Gluteus medius  (ant)      3
Model.PCSA(53,1) = 37.9/6       ;%Gluteus medius  (ant)      4
Model.PCSA(54,1) = 37.9/6       ;%Gluteus medius  (ant)      5
Model.PCSA(55,1) = 37.9/6       ;%Gluteus medius  (ant)      6
Model.PCSA(56,1) = 60.8/6       ;%Gluteus medius  (post) 1
Model.PCSA(57,1) = 60.8/6       ;%Gluteus medius  (post) 2
Model.PCSA(58,1) = 60.8/6       ;%Gluteus medius  (post) 3
Model.PCSA(59,1) = 60.8/6       ;%Gluteus medius  (post) 4
Model.PCSA(60,1) = 60.8/6       ;%Gluteus medius  (post) 5
Model.PCSA(61,1) = 60.8/6       ;%Gluteus medius  (post) 6
Model.PCSA(62,1) = 10           ;%Gluteus minimus  (ant)
Model.PCSA(63,1) = 8.1          ;%Gluteus minimus  (mid)
Model.PCSA(64,1) = 7.4          ;%Gluteus minimus  (post)
Model.PCSA(65,1) = 4.9/2        ;%Gracilis  1
Model.PCSA(66,1) = 4.9/2        ;%Gracilis  2
Model.PCSA(67,1) = (6.6+13+7.6)/3   ;%Illiacus
Model.PCSA(68,1) = 5.5/2        ;%Obturator ext  (inf) 1
Model.PCSA(69,1) = 5.5/2        ;%Obturator ext  (inf) 2
Model.PCSA(70,1) = 24.6/3       ;%Obturator ext  (sup) 1
Model.PCSA(71,1) = 24.6/3       ;%Obturator ext  (sup) 2
Model.PCSA(72,1) = 24.6/3       ;%Obturator ext  (sup) 3
Model.PCSA(73,1) = 25.4         ;%Obturator int
Model.PCSA(74,1) = 6.8/4        ;%Pectinus  1
Model.PCSA(75,1) = 6.8/4        ;%Pectinus  2
Model.PCSA(76,1) = 6.8/4        ;%Pectinus  3
Model.PCSA(77,1) = 6.8/4        ;%Pectinus  4
Model.PCSA(78,1) = 19           ;%Peroneus  brevis
Model.PCSA(79,1) = 23.9         ;%Peroneus  longus
Model.PCSA(80,1) = 6.2          ;%Peroneus tert
Model.PCSA(81,1) = 8.1          ;%Piriformis
Model.PCSA(82,1) = 2.4          ;%Plantaris
Model.PCSA(83,1) = 10.7         ;%Popliteus
Model.PCSA(84,1) = 1.1          ;%Psoas minor
Model.PCSA(85,1) = 19.5         ;%Psoas major
Model.PCSA(86,1) = 14.6/4       ;%Quadratis Femoris    1
Model.PCSA(87,1) = 14.6/4       ;%Quadratis Femoris    2
Model.PCSA(88,1) = 14.6/4       ;%Quadratis Femoris    3
Model.PCSA(89,1) = 14.6/4       ;%Quadratis Femoris    4
Model.PCSA(90,1) = 28.9/2       ;%Rectus Femoris   1
Model.PCSA(91,1) = 28.9/2       ;%Rectus Femoris   2
Model.PCSA(92,1) = 5.9          ;%Sartorius (prox)
Model.PCSA(93,1) = 5.9          ;%Sartorius (dist)
Model.PCSA(94,1) = 17.1         ;%Semimembranosus
Model.PCSA(95,1) = 14.7         ;%Semitendinus
Model.PCSA(96,1) = 94.3/3       ;%Soleus (med)  1
Model.PCSA(97,1) = 94.3/3       ;%Soleus (med)  2
Model.PCSA(98,1) = 94.3/3       ;%Soleus (med)  3
Model.PCSA(99,1) = 85.9/3       ;%Soleus (lat)   1
Model.PCSA(100,1) = 85.9/3       ;%Soleus (lat)   2
Model.PCSA(101,1) = 85.9/3      ;%Soleus (lat)   3
Model.PCSA(102,1) = 8.8/2       ;%Tensor fascia late  1
Model.PCSA(103,1) = 8.8/2       ;%Tensor fascia late   2
Model.PCSA(104,1) = 26.6        ;%Tibialis anterioris
Model.PCSA(105,1) = 21.6        ;%Tibial post. (med&lat)
Model.PCSA(106,1) = 38.1/6      ;%Vastus interm.  1
Model.PCSA(107,1) = 38.1/6      ;%Vastus interm.  2
Model.PCSA(108,1) = 38.1/6      ;%Vastus interm.  3
Model.PCSA(109,1) = 38.1/6      ;%Vastus interm.  4
Model.PCSA(110,1) = 38.1/6      ;%Vastus interm.  5
Model.PCSA(111,1) = 38.1/6      ;%Vastus interm.  6
Model.PCSA(112,1) = 10.7/6      ;%Vastus lat. (inf)  1
Model.PCSA(113,1) = 10.7/6      ;%Vastus lat. (inf)  2
Model.PCSA(114,1) = 10.7/6      ;%Vastus lat. (inf)  3
Model.PCSA(115,1) = 10.7/6      ;%Vastus lat. (inf)  4
Model.PCSA(116,1) = 10.7/6      ;%Vastus lat. (inf)  5
Model.PCSA(117,1) = 10.7/6      ;%Vastus lat. (inf)  6
Model.PCSA(118,1) = 59/2        ;%Vastus lat. (sup)  1
Model.PCSA(119,1) = 59/2        ;%Vastus lat. (sup)  2
Model.PCSA(120,1) = 9.8/2       ;%Vastus med (inf)  1
Model.PCSA(121,1) = 9.8/2       ;%Vastus med (inf)  2
Model.PCSA(122,1) = 23.2/2      ;%Vastus med (mid) 1
Model.PCSA(123,1) = 23.2/2      ;%Vastus med (mid) 2
Model.PCSA(124,1) = 26.9/6      ;%Vastus med. (sup) 1
Model.PCSA(125,1) = 26.9/6      ;%Vastus med. (sup) 2
Model.PCSA(126,1) = 26.9/6      ;%Vastus med. (sup) 3
Model.PCSA(127,1) = 26.9/6      ;%Vastus med. (sup) 4
Model.PCSA(128,1) = 26.9/6      ;%Vastus med. (sup) 5
Model.PCSA(129,1) = 26.9/6      ;%Vastus med. (sup) 6